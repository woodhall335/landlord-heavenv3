# Supabase Schema Snapshot (psql output)

> Generated via `psql` describe commands. This is read-only reference for AI (Claude / ChatGPT),
> not executable SQL.

✅ 1. Show all tables
SELECT table_schema, table_name
FROM information_schema.tables
WHERE table_schema = 'public'
ORDER BY table_name;


| table_schema | table_name                         |
| ------------ | ---------------------------------- |
| public       | ai_usage                           |
| public       | ai_usage_logs                      |
| public       | case_facts                         |
| public       | cases                              |
| public       | conversations                      |
| public       | councils                           |
| public       | councils_with_additional_licensing |
| public       | councils_with_selective_licensing  |
| public       | councils_with_strict_thresholds    |
| public       | documents                          |
| public       | hmo_compliance_items               |
| public       | hmo_properties                     |
| public       | hmo_tenants                        |
| public       | orders                             |
| public       | seo_automation_log                 |
| public       | seo_backlinks                      |
| public       | seo_content_queue                  |
| public       | seo_keywords                       |
| public       | seo_pages                          |
| public       | seo_performance                    |
| public       | uk_councils                        |
| public       | users                              |
| public       | webhook_logs                       |

✅ 2. Show the structure (DDL) of a table

Supabase does NOT support SHOW CREATE TABLE,
but you can use this:

SELECT
    table_name,
    column_name,
    data_type,
    is_nullable,
    column_default
FROM information_schema.columns
WHERE table_schema = 'public'
ORDER BY table_name, ordinal_position;

| table_name                         | column_name                  | data_type                | is_nullable | column_default      |
| ---------------------------------- | ---------------------------- | ------------------------ | ----------- | ------------------- |
| ai_usage                           | id                           | uuid                     | NO          | uuid_generate_v4()  |
| ai_usage                           | user_id                      | uuid                     | NO          | null                |
| ai_usage                           | model                        | text                     | NO          | null                |
| ai_usage                           | operation                    | text                     | NO          | null                |
| ai_usage                           | prompt_tokens                | integer                  | NO          | null                |
| ai_usage                           | completion_tokens            | integer                  | NO          | null                |
| ai_usage                           | total_tokens                 | integer                  | NO          | null                |
| ai_usage                           | cost_usd                     | numeric                  | NO          | null                |
| ai_usage                           | case_id                      | uuid                     | YES         | null                |
| ai_usage                           | document_id                  | uuid                     | YES         | null                |
| ai_usage                           | metadata                     | jsonb                    | YES         | '{}'::jsonb         |
| ai_usage                           | created_at                   | timestamp with time zone | YES         | now()               |
| ai_usage_logs                      | id                           | uuid                     | NO          | uuid_generate_v4()  |
| ai_usage_logs                      | model                        | text                     | NO          | null                |
| ai_usage_logs                      | operation_type               | text                     | NO          | null                |
| ai_usage_logs                      | input_tokens                 | integer                  | YES         | 0                   |
| ai_usage_logs                      | output_tokens                | integer                  | YES         | 0                   |
| ai_usage_logs                      | total_tokens                 | integer                  | YES         | 0                   |
| ai_usage_logs                      | total_cost_usd               | numeric                  | YES         | 0                   |
| ai_usage_logs                      | user_id                      | uuid                     | YES         | null                |
| ai_usage_logs                      | case_id                      | uuid                     | YES         | null                |
| ai_usage_logs                      | document_id                  | uuid                     | YES         | null                |
| ai_usage_logs                      | created_at                   | timestamp with time zone | YES         | now()               |
| case_facts                         | id                           | uuid                     | NO          | uuid_generate_v4()  |
| case_facts                         | case_id                      | uuid                     | NO          | null                |
| case_facts                         | facts                        | jsonb                    | NO          | '{}'::jsonb         |
| case_facts                         | validated_at                 | timestamp with time zone | YES         | null                |
| case_facts                         | validation_errors            | jsonb                    | YES         | null                |
| case_facts                         | version                      | integer                  | YES         | 1                   |
| case_facts                         | created_at                   | timestamp with time zone | YES         | now()               |
| case_facts                         | updated_at                   | timestamp with time zone | YES         | now()               |
| cases                              | id                           | uuid                     | NO          | uuid_generate_v4()  |
| cases                              | user_id                      | uuid                     | YES         | null                |
| cases                              | case_type                    | text                     | NO          | null                |
| cases                              | jurisdiction                 | text                     | NO          | null                |
| cases                              | status                       | text                     | YES         | 'in_progress'::text |
| cases                              | collected_facts              | jsonb                    | YES         | '{}'::jsonb         |
| cases                              | wizard_progress              | integer                  | YES         | 0                   |
| cases                              | wizard_completed_at          | timestamp with time zone | YES         | null                |
| cases                              | recommended_route            | text                     | YES         | null                |
| cases                              | recommended_grounds          | ARRAY                    | YES         | null                |
| cases                              | success_probability          | integer                  | YES         | null                |
| cases                              | red_flags                    | jsonb                    | YES         | '[]'::jsonb         |
| cases                              | compliance_issues            | jsonb                    | YES         | '[]'::jsonb         |
| cases                              | council_code                 | text                     | YES         | null                |
| cases                              | created_at                   | timestamp with time zone | YES         | now()               |
| cases                              | updated_at                   | timestamp with time zone | YES         | now()               |
| conversations                      | id                           | uuid                     | NO          | uuid_generate_v4()  |
| conversations                      | case_id                      | uuid                     | NO          | null                |
| conversations                      | role                         | text                     | NO          | null                |
| conversations                      | content                      | text                     | NO          | null                |
| conversations                      | model                        | text                     | YES         | null                |
| conversations                      | tokens_used                  | integer                  | YES         | null                |
| conversations                      | question_id                  | text                     | YES         | null                |
| conversations                      | input_type                   | text                     | YES         | null                |
| conversations                      | user_input                   | jsonb                    | YES         | null                |
| conversations                      | created_at                   | timestamp with time zone | YES         | now()               |
| councils                           | id                           | uuid                     | NO          | gen_random_uuid()   |
| councils                           | code                         | text                     | NO          | null                |
| councils                           | name                         | text                     | NO          | null                |
| councils                           | jurisdiction                 | text                     | NO          | null                |
| councils                           | region                       | text                     | NO          | null                |
| councils                           | website                      | text                     | YES         | null                |
| councils                           | hmo_licensing                | jsonb                    | NO          | null                |
| councils                           | hmo_thresholds               | jsonb                    | NO          | null                |
| councils                           | contact                      | jsonb                    | YES         | null                |
| councils                           | postcode_areas               | ARRAY                    | NO          | null                |
| councils                           | confidence                   | text                     | YES         | '✓✓'::text          |
| councils                           | created_at                   | timestamp with time zone | YES         | now()               |
| councils                           | updated_at                   | timestamp with time zone | YES         | now()               |
| councils_with_additional_licensing | code                         | text                     | YES         | null                |
| councils_with_additional_licensing | name                         | text                     | YES         | null                |
| councils_with_additional_licensing | jurisdiction                 | text                     | YES         | null                |
| councils_with_additional_licensing | region                       | text                     | YES         | null                |
| councils_with_additional_licensing | has_additional               | boolean                  | YES         | null                |
| councils_with_additional_licensing | schemes                      | jsonb                    | YES         | null                |
| councils_with_selective_licensing  | code                         | text                     | YES         | null                |
| councils_with_selective_licensing  | name                         | text                     | YES         | null                |
| councils_with_selective_licensing  | jurisdiction                 | text                     | YES         | null                |
| councils_with_selective_licensing  | region                       | text                     | YES         | null                |
| councils_with_selective_licensing  | has_selective                | boolean                  | YES         | null                |
| councils_with_selective_licensing  | schemes                      | jsonb                    | YES         | null                |
| councils_with_strict_thresholds    | code                         | text                     | YES         | null                |
| councils_with_strict_thresholds    | name                         | text                     | YES         | null                |
| councils_with_strict_thresholds    | jurisdiction                 | text                     | YES         | null                |
| councils_with_strict_thresholds    | region                       | text                     | YES         | null                |
| councils_with_strict_thresholds    | person_threshold             | integer                  | YES         | null                |
| documents                          | id                           | uuid                     | NO          | uuid_generate_v4()  |
| documents                          | user_id                      | uuid                     | YES         | null                |
| documents                          | case_id                      | uuid                     | YES         | null                |
| documents                          | document_type                | text                     | NO          | null                |
| documents                          | document_title               | text                     | NO          | null                |
| documents                          | jurisdiction                 | text                     | NO          | null                |
| documents                          | generated_by_model           | text                     | YES         | null                |
| documents                          | generation_tokens_used       | integer                  | YES         | null                |
| documents                          | generation_cost_usd          | numeric                  | YES         | null                |
| documents                          | qa_score                     | integer                  | YES         | null                |
| documents                          | qa_issues                    | jsonb                    | YES         | '[]'::jsonb         |
| documents                          | qa_passed                    | boolean                  | YES         | false               |
| documents                          | html_content                 | text                     | YES         | null                |
| documents                          | pdf_url                      | text                     | YES         | null                |
| documents                          | is_preview                   | boolean                  | YES         | true                |
| documents                          | created_at                   | timestamp with time zone | YES         | now()               |
| documents                          | updated_at                   | timestamp with time zone | YES         | now()               |
| hmo_compliance_items               | id                           | uuid                     | NO          | uuid_generate_v4()  |
| hmo_compliance_items               | property_id                  | uuid                     | NO          | null                |
| hmo_compliance_items               | user_id                      | uuid                     | NO          | null                |
| hmo_compliance_items               | item_type                    | text                     | NO          | null                |
| hmo_compliance_items               | item_title                   | text                     | NO          | null                |
| hmo_compliance_items               | description                  | text                     | YES         | null                |
| hmo_compliance_items               | due_date                     | date                     | NO          | null                |
| hmo_compliance_items               | completed_date               | date                     | YES         | null                |
| hmo_compliance_items               | status                       | text                     | YES         | 'upcoming'::text    |
| hmo_compliance_items               | reminder_sent                | boolean                  | YES         | false               |
| hmo_compliance_items               | reminder_sent_at             | timestamp with time zone | YES         | null                |
| hmo_compliance_items               | certificate_url              | text                     | YES         | null                |
| hmo_compliance_items               | created_at                   | timestamp with time zone | YES         | now()               |
| hmo_compliance_items               | updated_at                   | timestamp with time zone | YES         | now()               |
| hmo_properties                     | id                           | uuid                     | NO          | uuid_generate_v4()  |
| hmo_properties                     | user_id                      | uuid                     | NO          | null                |
| hmo_properties                     | property_name                | text                     | NO          | null                |
| hmo_properties                     | address_line1                | text                     | NO          | null                |
| hmo_properties                     | address_line2                | text                     | YES         | null                |
| hmo_properties                     | city                         | text                     | NO          | null                |
| hmo_properties                     | postcode                     | text                     | NO          | null                |
| hmo_properties                     | council_code                 | text                     | NO          | null                |
| hmo_properties                     | council_name                 | text                     | YES         | null                |
| hmo_properties                     | license_type                 | text                     | YES         | null                |
| hmo_properties                     | license_number               | text                     | YES         | null                |
| hmo_properties                     | license_expiry_date          | date                     | YES         | null                |
| hmo_properties                     | number_of_bedrooms           | integer                  | YES         | null                |
| hmo_properties                     | number_of_tenants            | integer                  | YES         | null                |
| hmo_properties                     | max_occupancy                | integer                  | YES         | null                |
| hmo_properties                     | number_of_bathrooms          | integer                  | YES         | null                |
| hmo_properties                     | number_of_kitchens           | integer                  | YES         | null                |
| hmo_properties                     | has_fire_alarm               | boolean                  | YES         | false               |
| hmo_properties                     | has_co_alarm                 | boolean                  | YES         | false               |
| hmo_properties                     | has_emergency_lighting       | boolean                  | YES         | false               |
| hmo_properties                     | has_fire_doors               | boolean                  | YES         | false               |
| hmo_properties                     | has_fire_blanket             | boolean                  | YES         | false               |
| hmo_properties                     | created_at                   | timestamp with time zone | YES         | now()               |
| hmo_properties                     | updated_at                   | timestamp with time zone | YES         | now()               |
| hmo_tenants                        | id                           | uuid                     | NO          | uuid_generate_v4()  |
| hmo_tenants                        | property_id                  | uuid                     | NO          | null                |
| hmo_tenants                        | user_id                      | uuid                     | NO          | null                |
| hmo_tenants                        | full_name                    | text                     | NO          | null                |
| hmo_tenants                        | email                        | text                     | YES         | null                |
| hmo_tenants                        | phone                        | text                     | YES         | null                |
| hmo_tenants                        | room_number                  | text                     | YES         | null                |
| hmo_tenants                        | move_in_date                 | date                     | NO          | null                |
| hmo_tenants                        | tenancy_end_date             | date                     | YES         | null                |
| hmo_tenants                        | move_out_date                | date                     | YES         | null                |
| hmo_tenants                        | monthly_rent                 | numeric                  | NO          | null                |
| hmo_tenants                        | deposit_amount               | numeric                  | YES         | null                |
| hmo_tenants                        | deposit_protected            | boolean                  | YES         | false               |
| hmo_tenants                        | deposit_scheme               | text                     | YES         | null                |
| hmo_tenants                        | tenancy_status               | text                     | YES         | 'active'::text      |
| hmo_tenants                        | created_at                   | timestamp with time zone | YES         | now()               |
| hmo_tenants                        | updated_at                   | timestamp with time zone | YES         | now()               |
| orders                             | id                           | uuid                     | NO          | uuid_generate_v4()  |
| orders                             | user_id                      | uuid                     | NO          | null                |
| orders                             | case_id                      | uuid                     | YES         | null                |
| orders                             | product_type                 | text                     | NO          | null                |
| orders                             | product_name                 | text                     | NO          | null                |
| orders                             | amount                       | numeric                  | NO          | null                |
| orders                             | currency                     | text                     | YES         | 'GBP'::text         |
| orders                             | total_amount                 | numeric                  | NO          | null                |
| orders                             | payment_status               | text                     | YES         | 'pending'::text     |
| orders                             | stripe_payment_intent_id     | text                     | YES         | null                |
| orders                             | stripe_charge_id             | text                     | YES         | null                |
| orders                             | paid_at                      | timestamp with time zone | YES         | null                |
| orders                             | fulfillment_status           | text                     | YES         | 'pending'::text     |
| orders                             | fulfilled_at                 | timestamp with time zone | YES         | null                |
| orders                             | created_at                   | timestamp with time zone | YES         | now()               |
| orders                             | updated_at                   | timestamp with time zone | YES         | now()               |
| seo_automation_log                 | id                           | uuid                     | NO          | gen_random_uuid()   |
| seo_automation_log                 | task_type                    | text                     | NO          | null                |
| seo_automation_log                 | task_name                    | text                     | NO          | null                |
| seo_automation_log                 | status                       | text                     | NO          | null                |
| seo_automation_log                 | started_at                   | timestamp with time zone | NO          | null                |
| seo_automation_log                 | completed_at                 | timestamp with time zone | YES         | null                |
| seo_automation_log                 | duration                     | integer                  | YES         | null                |
| seo_automation_log                 | items_processed              | integer                  | YES         | 0                   |
| seo_automation_log                 | items_successful             | integer                  | YES         | 0                   |
| seo_automation_log                 | items_failed                 | integer                  | YES         | 0                   |
| seo_automation_log                 | summary                      | text                     | YES         | null                |
| seo_automation_log                 | error_message                | text                     | YES         | null                |
| seo_automation_log                 | metadata                     | jsonb                    | YES         | null                |
| seo_automation_log                 | scheduled_time               | timestamp with time zone | YES         | null                |
| seo_automation_log                 | triggered_by                 | text                     | YES         | null                |
| seo_automation_log                 | created_at                   | timestamp with time zone | YES         | now()               |
| seo_backlinks                      | id                           | uuid                     | NO          | gen_random_uuid()   |
| seo_backlinks                      | target_domain                | text                     | NO          | null                |
| seo_backlinks                      | target_url                   | text                     | YES         | null                |
| seo_backlinks                      | contact_email                | text                     | YES         | null                |
| seo_backlinks                      | contact_name                 | text                     | YES         | null                |
| seo_backlinks                      | domain_authority             | integer                  | YES         | null                |
| seo_backlinks                      | domain_rating                | integer                  | YES         | null                |
| seo_backlinks                      | monthly_traffic              | integer                  | YES         | null                |
| seo_backlinks                      | relevance_score              | integer                  | YES         | null                |
| seo_backlinks                      | outreach_status              | text                     | NO          | 'identified'::text  |
| seo_backlinks                      | outreach_template            | text                     | YES         | null                |
| seo_backlinks                      | outreach_sent_at             | timestamp with time zone | YES         | null                |
| seo_backlinks                      | follow_up_sent_at            | timestamp with time zone | YES         | null                |
| seo_backlinks                      | follow_up_count              | integer                  | YES         | 0                   |
| seo_backlinks                      | response_received            | boolean                  | YES         | false               |
| seo_backlinks                      | response_date                | timestamp with time zone | YES         | null                |
| seo_backlinks                      | response_type                | text                     | YES         | null                |
| seo_backlinks                      | response_notes               | text                     | YES         | null                |
| seo_backlinks                      | acquired                     | boolean                  | YES         | false               |
| seo_backlinks                      | acquired_at                  | timestamp with time zone | YES         | null                |
| seo_backlinks                      | backlink_url                 | text                     | YES         | null                |
| seo_backlinks                      | target_page_url              | text                     | YES         | null                |
| seo_backlinks                      | anchor_text                  | text                     | YES         | null                |
| seo_backlinks                      | link_type                    | text                     | YES         | null                |
| seo_backlinks                      | cost_gbp                     | numeric                  | YES         | 0.00                |
| seo_backlinks                      | is_paid                      | boolean                  | YES         | false               |
| seo_backlinks                      | verified                     | boolean                  | YES         | false               |
| seo_backlinks                      | last_checked_at              | timestamp with time zone | YES         | null                |
| seo_backlinks                      | status_check_count           | integer                  | YES         | 0                   |
| seo_backlinks                      | link_category                | text                     | YES         | null                |
| seo_backlinks                      | niche                        | ARRAY                    | YES         | '{}'::text[]        |
| seo_backlinks                      | auto_discovered              | boolean                  | YES         | false               |
| seo_backlinks                      | discovery_method             | text                     | YES         | null                |
| seo_backlinks                      | created_at                   | timestamp with time zone | YES         | now()               |
| seo_backlinks                      | updated_at                   | timestamp with time zone | YES         | now()               |
| seo_content_queue                  | id                           | uuid                     | NO          | gen_random_uuid()   |
| seo_content_queue                  | content_type                 | text                     | NO          | null                |
| seo_content_queue                  | target_keyword               | text                     | NO          | null                |
| seo_content_queue                  | page_slug                    | text                     | YES         | null                |
| seo_content_queue                  | page_id                      | uuid                     | YES         | null                |
| seo_content_queue                  | location                     | text                     | YES         | null                |
| seo_content_queue                  | jurisdiction                 | text                     | YES         | null                |
| seo_content_queue                  | word_count_target            | integer                  | YES         | 1500                |
| seo_content_queue                  | ai_model                     | text                     | YES         | 'gpt-4o-mini'::text |
| seo_content_queue                  | generation_prompt            | text                     | YES         | null                |
| seo_content_queue                  | status                       | text                     | NO          | 'pending'::text     |
| seo_content_queue                  | priority                     | integer                  | YES         | 5                   |
| seo_content_queue                  | scheduled_for                | timestamp with time zone | YES         | now()               |
| seo_content_queue                  | started_at                   | timestamp with time zone | YES         | null                |
| seo_content_queue                  | completed_at                 | timestamp with time zone | YES         | null                |
| seo_content_queue                  | processing_time              | integer                  | YES         | null                |
| seo_content_queue                  | generated_content            | text                     | YES         | null                |
| seo_content_queue                  | quality_score                | integer                  | YES         | null                |
| seo_content_queue                  | error_message                | text                     | YES         | null                |
| seo_content_queue                  | created_at                   | timestamp with time zone | YES         | now()               |
| seo_content_queue                  | updated_at                   | timestamp with time zone | YES         | now()               |
| seo_keywords                       | id                           | uuid                     | NO          | gen_random_uuid()   |
| seo_keywords                       | keyword                      | text                     | NO          | null                |
| seo_keywords                       | search_volume                | integer                  | YES         | 0                   |
| seo_keywords                       | difficulty                   | integer                  | YES         | 0                   |
| seo_keywords                       | cpc                          | numeric                  | YES         | 0.00                |
| seo_keywords                       | intent                       | text                     | YES         | null                |
| seo_keywords                       | category                     | text                     | YES         | null                |
| seo_keywords                       | jurisdiction                 | text                     | YES         | null                |
| seo_keywords                       | location                     | text                     | YES         | null                |
| seo_keywords                       | serp_features                | ARRAY                    | YES         | '{}'::text[]        |
| seo_keywords                       | top_ranking_domains          | ARRAY                    | YES         | '{}'::text[]        |
| seo_keywords                       | content_gaps                 | ARRAY                    | YES         | null                |
| seo_keywords                       | status                       | text                     | NO          | 'identified'::text  |
| seo_keywords                       | priority                     | integer                  | YES         | 0                   |
| seo_keywords                       | assigned_page_id             | uuid                     | YES         | null                |
| seo_keywords                       | current_rank                 | integer                  | YES         | null                |
| seo_keywords                       | rank_history                 | jsonb                    | YES         | '[]'::jsonb         |
| seo_keywords                       | created_at                   | timestamp with time zone | YES         | now()               |
| seo_keywords                       | updated_at                   | timestamp with time zone | YES         | now()               |
| seo_pages                          | id                           | uuid                     | NO          | gen_random_uuid()   |
| seo_pages                          | slug                         | text                     | NO          | null                |
| seo_pages                          | title                        | text                     | NO          | null                |
| seo_pages                          | meta_description             | text                     | NO          | null                |
| seo_pages                          | h1                           | text                     | NO          | null                |
| seo_pages                          | content                      | text                     | NO          | null                |
| seo_pages                          | content_type                 | text                     | NO          | 'location'::text    |
| seo_pages                          | target_keyword               | text                     | NO          | null                |
| seo_pages                          | secondary_keywords           | ARRAY                    | YES         | '{}'::text[]        |
| seo_pages                          | search_volume                | integer                  | YES         | 0                   |
| seo_pages                          | keyword_difficulty           | integer                  | YES         | 0                   |
| seo_pages                          | location                     | text                     | YES         | null                |
| seo_pages                          | region                       | text                     | YES         | null                |
| seo_pages                          | jurisdiction                 | text                     | YES         | null                |
| seo_pages                          | word_count                   | integer                  | YES         | 0                   |
| seo_pages                          | readability_score            | integer                  | YES         | 0                   |
| seo_pages                          | ai_quality_score             | integer                  | YES         | 0                   |
| seo_pages                          | status                       | text                     | NO          | 'draft'::text       |
| seo_pages                          | published_at                 | timestamp with time zone | YES         | null                |
| seo_pages                          | last_refreshed_at            | timestamp with time zone | YES         | null                |
| seo_pages                          | views                        | integer                  | YES         | 0                   |
| seo_pages                          | unique_visitors              | integer                  | YES         | 0                   |
| seo_pages                          | avg_time_on_page             | integer                  | YES         | 0                   |
| seo_pages                          | bounce_rate                  | numeric                  | YES         | 0.00                |
| seo_pages                          | conversions                  | integer                  | YES         | 0                   |
| seo_pages                          | current_rank                 | integer                  | YES         | null                |
| seo_pages                          | best_rank                    | integer                  | YES         | null                |
| seo_pages                          | rank_history                 | jsonb                    | YES         | '[]'::jsonb         |
| seo_pages                          | internal_links               | ARRAY                    | YES         | '{}'::text[]        |
| seo_pages                          | backlinks_count              | integer                  | YES         | 0                   |
| seo_pages                          | schema_markup                | jsonb                    | YES         | null                |
| seo_pages                          | auto_refresh                 | boolean                  | YES         | true                |
| seo_pages                          | last_generated_by            | text                     | YES         | null                |
| seo_pages                          | generation_prompt            | text                     | YES         | null                |
| seo_pages                          | created_at                   | timestamp with time zone | YES         | now()               |
| seo_pages                          | updated_at                   | timestamp with time zone | YES         | now()               |
| seo_performance                    | id                           | uuid                     | NO          | gen_random_uuid()   |
| seo_performance                    | date                         | date                     | NO          | null                |
| seo_performance                    | page_id                      | uuid                     | YES         | null                |
| seo_performance                    | sessions                     | integer                  | YES         | 0                   |
| seo_performance                    | unique_visitors              | integer                  | YES         | 0                   |
| seo_performance                    | page_views                   | integer                  | YES         | 0                   |
| seo_performance                    | avg_session_duration         | integer                  | YES         | 0                   |
| seo_performance                    | bounce_rate                  | numeric                  | YES         | 0.00                |
| seo_performance                    | conversions                  | integer                  | YES         | 0                   |
| seo_performance                    | conversion_rate              | numeric                  | YES         | 0.00                |
| seo_performance                    | revenue_gbp                  | numeric                  | YES         | 0.00                |
| seo_performance                    | organic_traffic              | integer                  | YES         | 0                   |
| seo_performance                    | organic_keywords_ranking     | integer                  | YES         | 0                   |
| seo_performance                    | average_rank                 | numeric                  | YES         | null                |
| seo_performance                    | new_backlinks                | integer                  | YES         | 0                   |
| seo_performance                    | lost_backlinks               | integer                  | YES         | 0                   |
| seo_performance                    | total_backlinks              | integer                  | YES         | 0                   |
| seo_performance                    | page_load_time               | integer                  | YES         | null                |
| seo_performance                    | core_web_vitals_score        | integer                  | YES         | null                |
| seo_performance                    | mobile_usability_score       | integer                  | YES         | null                |
| seo_performance                    | competitor_rank_comparison   | jsonb                    | YES         | null                |
| seo_performance                    | created_at                   | timestamp with time zone | YES         | now()               |
| seo_performance                    | updated_at                   | timestamp with time zone | YES         | now()               |
| uk_councils                        | id                           | uuid                     | NO          | uuid_generate_v4()  |
| uk_councils                        | council_code                 | text                     | NO          | null                |
| uk_councils                        | council_name                 | text                     | NO          | null                |
| uk_councils                        | region                       | text                     | NO          | null                |
| uk_councils                        | country                      | text                     | NO          | null                |
| uk_councils                        | postcode_areas               | ARRAY                    | YES         | null                |
| uk_councils                        | has_mandatory_licensing      | boolean                  | YES         | true                |
| uk_councils                        | has_additional_licensing     | boolean                  | YES         | false               |
| uk_councils                        | has_selective_licensing      | boolean                  | YES         | false               |
| uk_councils                        | licensing_criteria           | jsonb                    | YES         | '{}'::jsonb         |
| uk_councils                        | application_process          | jsonb                    | YES         | '{}'::jsonb         |
| uk_councils                        | fees                         | jsonb                    | YES         | '{}'::jsonb         |
| uk_councils                        | requirements                 | jsonb                    | YES         | '{}'::jsonb         |
| uk_councils                        | standards                    | jsonb                    | YES         | '{}'::jsonb         |
| uk_councils                        | contact_info                 | jsonb                    | YES         | '{}'::jsonb         |
| uk_councils                        | useful_links                 | jsonb                    | YES         | '{}'::jsonb         |
| uk_councils                        | created_at                   | timestamp with time zone | YES         | now()               |
| uk_councils                        | updated_at                   | timestamp with time zone | YES         | now()               |
| users                              | id                           | uuid                     | NO          | null                |
| users                              | email                        | text                     | NO          | null                |
| users                              | full_name                    | text                     | YES         | null                |
| users                              | phone                        | text                     | YES         | null                |
| users                              | stripe_customer_id           | text                     | YES         | null                |
| users                              | stripe_subscription_id       | text                     | YES         | null                |
| users                              | hmo_pro_active               | boolean                  | YES         | false               |
| users                              | hmo_pro_tier                 | text                     | YES         | null                |
| users                              | hmo_pro_trial_ends_at        | timestamp with time zone | YES         | null                |
| users                              | hmo_pro_subscription_ends_at | timestamp with time zone | YES         | null                |
| users                              | created_at                   | timestamp with time zone | YES         | now()               |
| users                              | updated_at                   | timestamp with time zone | YES         | now()               |
| webhook_logs                       | id                           | uuid                     | NO          | uuid_generate_v4()  |
| webhook_logs                       | event_type                   | text                     | NO          | null                |
| webhook_logs                       | stripe_event_id              | text                     | YES         | null                |
| webhook_logs                       | payload                      | jsonb                    | YES         | '{}'::jsonb         |
| webhook_logs                       | status                       | text                     | YES         | 'received'::text    |
| webhook_logs                       | error_message                | text                     | YES         | null                |
| webhook_logs                       | created_at                   | timestamp with time zone | YES         | now()               |
| webhook_logs                       | processed_at                 | timestamp with time zone | YES         | null                |

SELECT
    'CREATE TABLE ' || table_name || E' (\n' ||
    string_agg(
        '    ' || column_name || ' ' || udt_name ||
        CASE WHEN is_nullable = 'NO' THEN ' NOT NULL' ELSE '' END ||
        CASE WHEN column_default IS NOT NULL THEN ' DEFAULT ' || column_default ELSE '' END,
        E',\n'
    ) ||
    E'\n);'
FROM information_schema.columns
WHERE table_schema = 'public'
GROUP BY table_name;

| ?column?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CREATE TABLE ai_usage (
    metadata jsonb DEFAULT '{}'::jsonb,
    document_id uuid,
    case_id uuid,
    operation text NOT NULL,
    cost_usd numeric NOT NULL,
    total_tokens int4 NOT NULL,
    model text NOT NULL,
    created_at timestamptz DEFAULT now(),
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    user_id uuid NOT NULL,
    prompt_tokens int4 NOT NULL,
    completion_tokens int4 NOT NULL
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| CREATE TABLE ai_usage_logs (
    model text NOT NULL,
    input_tokens int4 DEFAULT 0,
    output_tokens int4 DEFAULT 0,
    total_tokens int4 DEFAULT 0,
    total_cost_usd numeric DEFAULT 0,
    user_id uuid,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    case_id uuid,
    document_id uuid,
    created_at timestamptz DEFAULT now(),
    operation_type text NOT NULL
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| CREATE TABLE case_facts (
    case_id uuid NOT NULL,
    facts jsonb NOT NULL DEFAULT '{}'::jsonb,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    validated_at timestamptz,
    validation_errors jsonb,
    version int4 DEFAULT 1,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now()
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| CREATE TABLE cases (
    user_id uuid,
    collected_facts jsonb DEFAULT '{}'::jsonb,
    wizard_progress int4 DEFAULT 0,
    wizard_completed_at timestamptz,
    success_probability int4,
    jurisdiction text NOT NULL,
    case_type text NOT NULL,
    council_code text,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    red_flags jsonb DEFAULT '[]'::jsonb,
    recommended_grounds _text,
    recommended_route text,
    status text DEFAULT 'in_progress'::text,
    compliance_issues jsonb DEFAULT '[]'::jsonb,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now()
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| CREATE TABLE conversations (
    role text NOT NULL,
    question_id text,
    user_input jsonb,
    tokens_used int4,
    case_id uuid NOT NULL,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    content text NOT NULL,
    model text,
    input_type text,
    created_at timestamptz DEFAULT now()
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| CREATE TABLE councils (
    confidence text DEFAULT '✓✓'::text,
    hmo_thresholds jsonb NOT NULL,
    id uuid NOT NULL DEFAULT gen_random_uuid(),
    postcode_areas _text NOT NULL,
    updated_at timestamptz DEFAULT now(),
    name text NOT NULL,
    website text,
    region text NOT NULL,
    hmo_licensing jsonb NOT NULL,
    created_at timestamptz DEFAULT now(),
    contact jsonb,
    code text NOT NULL,
    jurisdiction text NOT NULL
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| CREATE TABLE councils_with_additional_licensing (
    name text,
    has_additional bool,
    schemes jsonb,
    region text,
    jurisdiction text,
    code text
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| CREATE TABLE councils_with_selective_licensing (
    schemes jsonb,
    name text,
    jurisdiction text,
    region text,
    has_selective bool,
    code text
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| CREATE TABLE councils_with_strict_thresholds (
    person_threshold int4,
    name text,
    code text,
    region text,
    jurisdiction text
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| CREATE TABLE documents (
    document_title text NOT NULL,
    jurisdiction text NOT NULL,
    pdf_url text,
    generated_by_model text,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    case_id uuid,
    user_id uuid,
    generation_tokens_used int4,
    generation_cost_usd numeric,
    qa_score int4,
    qa_issues jsonb DEFAULT '[]'::jsonb,
    qa_passed bool DEFAULT false,
    is_preview bool DEFAULT true,
    updated_at timestamptz DEFAULT now(),
    created_at timestamptz DEFAULT now(),
    html_content text,
    document_type text NOT NULL
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| CREATE TABLE hmo_compliance_items (
    updated_at timestamptz DEFAULT now(),
    created_at timestamptz DEFAULT now(),
    reminder_sent_at timestamptz,
    reminder_sent bool DEFAULT false,
    completed_date date,
    due_date date NOT NULL,
    user_id uuid NOT NULL,
    property_id uuid NOT NULL,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    item_type text NOT NULL,
    item_title text NOT NULL,
    description text,
    status text DEFAULT 'upcoming'::text,
    certificate_url text
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| CREATE TABLE hmo_properties (
    max_occupancy int4,
    number_of_bathrooms int4,
    number_of_kitchens int4,
    has_fire_alarm bool DEFAULT false,
    license_type text,
    license_number text,
    has_co_alarm bool DEFAULT false,
    has_emergency_lighting bool DEFAULT false,
    has_fire_doors bool DEFAULT false,
    has_fire_blanket bool DEFAULT false,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now(),
    council_name text,
    address_line1 text NOT NULL,
    council_code text NOT NULL,
    address_line2 text,
    property_name text NOT NULL,
    postcode text NOT NULL,
    city text NOT NULL,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    user_id uuid NOT NULL,
    license_expiry_date date,
    number_of_bedrooms int4,
    number_of_tenants int4
);                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| CREATE TABLE hmo_tenants (
    created_at timestamptz DEFAULT now(),
    tenancy_status text DEFAULT 'active'::text,
    deposit_scheme text,
    room_number text,
    phone text,
    email text,
    full_name text NOT NULL,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    property_id uuid NOT NULL,
    user_id uuid NOT NULL,
    move_in_date date NOT NULL,
    tenancy_end_date date,
    move_out_date date,
    monthly_rent numeric NOT NULL,
    deposit_amount numeric,
    deposit_protected bool DEFAULT false,
    updated_at timestamptz DEFAULT now()
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| CREATE TABLE orders (
    amount numeric NOT NULL,
    product_type text NOT NULL,
    product_name text NOT NULL,
    currency text DEFAULT 'GBP'::text,
    payment_status text DEFAULT 'pending'::text,
    stripe_payment_intent_id text,
    stripe_charge_id text,
    fulfillment_status text DEFAULT 'pending'::text,
    total_amount numeric NOT NULL,
    paid_at timestamptz,
    case_id uuid,
    fulfilled_at timestamptz,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now(),
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    user_id uuid NOT NULL
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CREATE TABLE seo_automation_log (
    scheduled_time timestamptz,
    summary text,
    task_name text NOT NULL,
    id uuid NOT NULL DEFAULT gen_random_uuid(),
    created_at timestamptz DEFAULT now(),
    status text NOT NULL,
    metadata jsonb,
    items_failed int4 DEFAULT 0,
    task_type text NOT NULL,
    items_successful int4 DEFAULT 0,
    items_processed int4 DEFAULT 0,
    error_message text,
    duration int4,
    completed_at timestamptz,
    started_at timestamptz NOT NULL,
    triggered_by text
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| CREATE TABLE seo_backlinks (
    is_paid bool DEFAULT false,
    cost_gbp numeric DEFAULT 0.00,
    acquired bool DEFAULT false,
    acquired_at timestamptz,
    response_date timestamptz,
    response_received bool DEFAULT false,
    follow_up_count int4 DEFAULT 0,
    follow_up_sent_at timestamptz,
    outreach_sent_at timestamptz,
    relevance_score int4,
    monthly_traffic int4,
    domain_rating int4,
    domain_authority int4,
    id uuid NOT NULL DEFAULT gen_random_uuid(),
    backlink_url text,
    target_domain text NOT NULL,
    target_url text,
    contact_email text,
    contact_name text,
    response_type text,
    link_category text,
    target_page_url text,
    anchor_text text,
    link_type text,
    discovery_method text,
    outreach_status text NOT NULL DEFAULT 'identified'::text,
    outreach_template text,
    response_notes text,
    niche _text DEFAULT '{}'::text[],
    updated_at timestamptz DEFAULT now(),
    created_at timestamptz DEFAULT now(),
    auto_discovered bool DEFAULT false,
    status_check_count int4 DEFAULT 0,
    last_checked_at timestamptz,
    verified bool DEFAULT false
);                                                                                                         |
| CREATE TABLE seo_content_queue (
    content_type text NOT NULL,
    id uuid NOT NULL DEFAULT gen_random_uuid(),
    page_id uuid,
    word_count_target int4 DEFAULT 1500,
    priority int4 DEFAULT 5,
    scheduled_for timestamptz DEFAULT now(),
    started_at timestamptz,
    completed_at timestamptz,
    processing_time int4,
    quality_score int4,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now(),
    target_keyword text NOT NULL,
    page_slug text,
    location text,
    jurisdiction text,
    ai_model text DEFAULT 'gpt-4o-mini'::text,
    generation_prompt text,
    status text NOT NULL DEFAULT 'pending'::text,
    generated_content text,
    error_message text
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| CREATE TABLE seo_keywords (
    id uuid NOT NULL DEFAULT gen_random_uuid(),
    category text,
    search_volume int4 DEFAULT 0,
    difficulty int4 DEFAULT 0,
    jurisdiction text,
    location text,
    cpc numeric DEFAULT 0.00,
    priority int4 DEFAULT 0,
    assigned_page_id uuid,
    status text NOT NULL DEFAULT 'identified'::text,
    content_gaps _text,
    current_rank int4,
    rank_history jsonb DEFAULT '[]'::jsonb,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now(),
    top_ranking_domains _text DEFAULT '{}'::text[],
    serp_features _text DEFAULT '{}'::text[],
    intent text,
    keyword text NOT NULL
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| CREATE TABLE seo_pages (
    word_count int4 DEFAULT 0,
    meta_description text NOT NULL,
    h1 text NOT NULL,
    content text NOT NULL,
    content_type text NOT NULL DEFAULT 'location'::text,
    published_at timestamptz,
    ai_quality_score int4 DEFAULT 0,
    last_generated_by text,
    internal_links _text DEFAULT '{}'::text[],
    status text NOT NULL DEFAULT 'draft'::text,
    id uuid NOT NULL DEFAULT gen_random_uuid(),
    jurisdiction text,
    region text,
    location text,
    search_volume int4 DEFAULT 0,
    keyword_difficulty int4 DEFAULT 0,
    title text NOT NULL,
    updated_at timestamptz DEFAULT now(),
    created_at timestamptz DEFAULT now(),
    auto_refresh bool DEFAULT true,
    schema_markup jsonb,
    backlinks_count int4 DEFAULT 0,
    rank_history jsonb DEFAULT '[]'::jsonb,
    best_rank int4,
    current_rank int4,
    conversions int4 DEFAULT 0,
    bounce_rate numeric DEFAULT 0.00,
    avg_time_on_page int4 DEFAULT 0,
    secondary_keywords _text DEFAULT '{}'::text[],
    target_keyword text NOT NULL,
    generation_prompt text,
    unique_visitors int4 DEFAULT 0,
    readability_score int4 DEFAULT 0,
    slug text NOT NULL,
    views int4 DEFAULT 0,
    last_refreshed_at timestamptz
); |
| CREATE TABLE seo_performance (
    mobile_usability_score int4,
    competitor_rank_comparison jsonb,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now(),
    conversion_rate numeric DEFAULT 0.00,
    revenue_gbp numeric DEFAULT 0.00,
    conversions int4 DEFAULT 0,
    bounce_rate numeric DEFAULT 0.00,
    avg_session_duration int4 DEFAULT 0,
    page_views int4 DEFAULT 0,
    unique_visitors int4 DEFAULT 0,
    sessions int4 DEFAULT 0,
    page_id uuid,
    date date NOT NULL,
    id uuid NOT NULL DEFAULT gen_random_uuid(),
    organic_traffic int4 DEFAULT 0,
    organic_keywords_ranking int4 DEFAULT 0,
    average_rank numeric,
    new_backlinks int4 DEFAULT 0,
    lost_backlinks int4 DEFAULT 0,
    total_backlinks int4 DEFAULT 0,
    page_load_time int4,
    core_web_vitals_score int4
);                                                                                                                                                                                                                                                                                                                                                                                                                         |
| CREATE TABLE uk_councils (
    created_at timestamptz DEFAULT now(),
    licensing_criteria jsonb DEFAULT '{}'::jsonb,
    has_selective_licensing bool DEFAULT false,
    has_additional_licensing bool DEFAULT false,
    has_mandatory_licensing bool DEFAULT true,
    id uuid NOT NULL DEFAULT uuid_generate_v4(),
    council_code text NOT NULL,
    updated_at timestamptz DEFAULT now(),
    fees jsonb DEFAULT '{}'::jsonb,
    council_name text NOT NULL,
    application_process jsonb DEFAULT '{}'::jsonb,
    useful_links jsonb DEFAULT '{}'::jsonb,
    contact_info jsonb DEFAULT '{}'::jsonb,
    standards jsonb DEFAULT '{}'::jsonb,
    requirements jsonb DEFAULT '{}'::jsonb,
    postcode_areas _text,
    country text NOT NULL,
    region text NOT NULL
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| CREATE TABLE users (
    hmo_pro_active bool DEFAULT false,
    stripe_subscription_id text,
    hmo_pro_trial_ends_at timestamptz,
    hmo_pro_subscription_ends_at timestamptz,
    created_at timestamptz DEFAULT now(),
    updated_at timestamptz DEFAULT now(),
    hmo_pro_tier text,
    email text NOT NULL,
    stripe_customer_id text,
    full_name text,
    phone text,
    id uuid NOT NULL
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| CREATE TABLE webhook_logs (
    payload jsonb DEFAULT '{}'::jsonb,
    event_type text NOT NULL,
    processed_at timestamptz,
    created_at timestamptz DEFAULT now(),
    status text DEFAULT 'received'::text,
    stripe_event_id text,
    error_message text,
    id uuid NOT NULL DEFAULT uuid_generate_v4()
);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

✅ 3. Show foreign keys
SELECT
    tc.table_name,
    kcu.column_name,
    ccu.table_name AS foreign_table,
    ccu.column_name AS foreign_column
FROM
    information_schema.table_constraints AS tc
JOIN information_schema.key_column_usage AS kcu
    ON tc.constraint_name = kcu.constraint_name
JOIN information_schema.constraint_column_usage AS ccu
    ON ccu.constraint_name = tc.constraint_name
WHERE tc.constraint_type = 'FOREIGN KEY';

| table_name           | column_name      | foreign_table  | foreign_column |
| -------------------- | ---------------- | -------------- | -------------- |
| cases                | user_id          | users          | id             |
| documents            | user_id          | users          | id             |
| documents            | case_id          | cases          | id             |
| orders               | user_id          | users          | id             |
| orders               | case_id          | cases          | id             |
| hmo_properties       | user_id          | users          | id             |
| hmo_tenants          | property_id      | hmo_properties | id             |
| hmo_tenants          | user_id          | users          | id             |
| hmo_compliance_items | property_id      | hmo_properties | id             |
| hmo_compliance_items | user_id          | users          | id             |
| ai_usage_logs        | user_id          | users          | id             |
| ai_usage_logs        | case_id          | cases          | id             |
| ai_usage_logs        | document_id      | documents      | id             |
| ai_usage             | user_id          | users          | id             |
| ai_usage             | case_id          | cases          | id             |
| ai_usage             | document_id      | documents      | id             |
| seo_keywords         | assigned_page_id | seo_pages      | id             |
| seo_content_queue    | page_id          | seo_pages      | id             |
| seo_performance      | page_id          | seo_pages      | id             |
| case_facts           | case_id          | cases          | id             |
| conversations        | case_id          | cases          | id             |

✅ 4. Show primary keys
SELECT
    tc.table_name,
    kcu.column_name
FROM
    information_schema.table_constraints AS tc
JOIN information_schema.key_column_usage AS kcu
    ON tc.constraint_name = kcu.constraint_name
WHERE tc.constraint_type = 'PRIMARY KEY';

| table_name                 | column_name |
| -------------------------- | ----------- |
| users                      | id          |
| users                      | id          |
| refresh_tokens             | id          |
| instances                  | id          |
| audit_log_entries          | id          |
| buckets                    | id          |
| objects                    | id          |
| secrets                    | id          |
| schema_migrations          | version     |
| schema_migrations          | version     |
| messages                   | id          |
| messages                   | inserted_at |
| sessions                   | id          |
| mfa_factors                | id          |
| mfa_challenges             | id          |
| mfa_amr_claims             | id          |
| sso_providers              | id          |
| sso_domains                | id          |
| saml_providers             | id          |
| saml_relay_states          | id          |
| flow_state                 | id          |
| identities                 | id          |
| one_time_tokens            | id          |
| oauth_clients              | id          |
| s3_multipart_uploads_parts | id          |
| subscription               | id          |
| oauth_authorizations       | id          |
| oauth_consents             | id          |
| s3_multipart_uploads       | id          |
| prefixes                   | bucket_id   |
| prefixes                   | level       |
| prefixes                   | name        |
| buckets_analytics          | id          |
| users                      | id          |
| users                      | id          |
| cases                      | id          |
| documents                  | id          |
| orders                     | id          |
| hmo_properties             | id          |
| hmo_tenants                | id          |
| hmo_compliance_items       | id          |
| uk_councils                | id          |
| ai_usage_logs              | id          |
| webhook_logs               | id          |
| councils                   | id          |
| ai_usage                   | id          |
| seo_pages                  | id          |
| seo_keywords               | id          |
| seo_content_queue          | id          |
| seo_backlinks              | id          |
| seo_performance            | id          |
| seo_automation_log         | id          |
| case_facts                 | id          |
| conversations              | id          |

✅ 5. Show indexes
SELECT
    t.relname AS table_name,
    i.relname AS index_name,
    a.attname AS column_name
FROM
    pg_class t,
    pg_class i,
    pg_index ix,
    pg_attribute a
WHERE
    t.oid = ix.indrelid
    AND i.oid = ix.indexrelid
    AND a.attrelid = t.oid
    AND a.attnum = ANY(ix.indkey)
ORDER BY
    t.relname, i.relname;

| table_name                 | index_name                                           | column_name                |
| -------------------------- | ---------------------------------------------------- | -------------------------- |
| ai_usage                   | ai_usage_pkey                                        | id                         |
| ai_usage                   | idx_ai_usage_case_id                                 | case_id                    |
| ai_usage                   | idx_ai_usage_created_at                              | created_at                 |
| ai_usage                   | idx_ai_usage_document_id                             | document_id                |
| ai_usage                   | idx_ai_usage_model                                   | model                      |
| ai_usage                   | idx_ai_usage_operation                               | operation                  |
| ai_usage                   | idx_ai_usage_user_id                                 | user_id                    |
| ai_usage_logs              | ai_usage_logs_pkey                                   | id                         |
| ai_usage_logs              | idx_ai_logs_created_at                               | created_at                 |
| ai_usage_logs              | idx_ai_logs_model                                    | model                      |
| ai_usage_logs              | idx_ai_logs_user_id                                  | user_id                    |
| audit_log_entries          | audit_log_entries_pkey                               | id                         |
| audit_log_entries          | audit_logs_instance_id_idx                           | instance_id                |
| buckets                    | bname                                                | name                       |
| buckets                    | buckets_pkey                                         | id                         |
| buckets_analytics          | buckets_analytics_pkey                               | id                         |
| buckets_analytics          | buckets_analytics_unique_name_idx                    | name                       |
| buckets_vectors            | buckets_vectors_pkey                                 | id                         |
| case_facts                 | case_facts_pkey                                      | id                         |
| case_facts                 | idx_case_facts_case_id                               | case_id                    |
| cases                      | cases_pkey                                           | id                         |
| cases                      | idx_cases_case_type                                  | case_type                  |
| cases                      | idx_cases_council_code                               | council_code               |
| cases                      | idx_cases_jurisdiction                               | jurisdiction               |
| cases                      | idx_cases_null_user_id                               | created_at                 |
| cases                      | idx_cases_status                                     | status                     |
| cases                      | idx_cases_user_id                                    | user_id                    |
| conversations              | conversations_pkey                                   | id                         |
| conversations              | idx_conversations_case_id                            | created_at                 |
| conversations              | idx_conversations_case_id                            | case_id                    |
| councils                   | councils_code_key                                    | code                       |
| councils                   | councils_pkey                                        | id                         |
| councils                   | idx_councils_hmo_licensing                           | hmo_licensing              |
| councils                   | idx_councils_jurisdiction                            | jurisdiction               |
| documents                  | documents_pkey                                       | id                         |
| documents                  | idx_documents_case_id                                | case_id                    |
| documents                  | idx_documents_document_type                          | document_type              |
| documents                  | idx_documents_null_user_id                           | created_at                 |
| documents                  | idx_documents_user_id                                | user_id                    |
| flow_state                 | flow_state_created_at_idx                            | created_at                 |
| flow_state                 | flow_state_pkey                                      | id                         |
| flow_state                 | idx_auth_code                                        | auth_code                  |
| flow_state                 | idx_user_id_auth_method                              | authentication_method      |
| flow_state                 | idx_user_id_auth_method                              | user_id                    |
| hmo_compliance_items       | hmo_compliance_items_pkey                            | id                         |
| hmo_compliance_items       | idx_compliance_due_date                              | due_date                   |
| hmo_compliance_items       | idx_compliance_property_id                           | property_id                |
| hmo_compliance_items       | idx_compliance_status                                | status                     |
| hmo_compliance_items       | idx_compliance_user_id                               | user_id                    |
| hmo_properties             | hmo_properties_pkey                                  | id                         |
| hmo_properties             | idx_hmo_properties_council_code                      | council_code               |
| hmo_properties             | idx_hmo_properties_postcode                          | postcode                   |
| hmo_properties             | idx_hmo_properties_user_id                           | user_id                    |
| hmo_tenants                | hmo_tenants_pkey                                     | id                         |
| hmo_tenants                | idx_hmo_tenants_property_id                          | property_id                |
| hmo_tenants                | idx_hmo_tenants_status                               | tenancy_status             |
| hmo_tenants                | idx_hmo_tenants_user_id                              | user_id                    |
| identities                 | identities_email_idx                                 | email                      |
| identities                 | identities_pkey                                      | id                         |
| identities                 | identities_provider_id_provider_unique               | provider                   |
| identities                 | identities_provider_id_provider_unique               | provider_id                |
| identities                 | identities_user_id_idx                               | user_id                    |
| instances                  | instances_pkey                                       | id                         |
| messages                   | messages_inserted_at_topic_index                     | topic                      |
| messages                   | messages_inserted_at_topic_index                     | inserted_at                |
| messages                   | messages_pkey                                        | id                         |
| messages                   | messages_pkey                                        | inserted_at                |
| mfa_amr_claims             | amr_id_pk                                            | id                         |
| mfa_amr_claims             | mfa_amr_claims_session_id_authentication_method_pkey | session_id                 |
| mfa_amr_claims             | mfa_amr_claims_session_id_authentication_method_pkey | authentication_method      |
| mfa_challenges             | mfa_challenge_created_at_idx                         | created_at                 |
| mfa_challenges             | mfa_challenges_pkey                                  | id                         |
| mfa_factors                | factor_id_created_at_idx                             | created_at                 |
| mfa_factors                | factor_id_created_at_idx                             | user_id                    |
| mfa_factors                | mfa_factors_last_challenged_at_key                   | last_challenged_at         |
| mfa_factors                | mfa_factors_pkey                                     | id                         |
| mfa_factors                | mfa_factors_user_friendly_name_unique                | user_id                    |
| mfa_factors                | mfa_factors_user_friendly_name_unique                | friendly_name              |
| mfa_factors                | mfa_factors_user_id_idx                              | user_id                    |
| mfa_factors                | unique_phone_factor_per_user                         | phone                      |
| mfa_factors                | unique_phone_factor_per_user                         | user_id                    |
| migrations                 | migrations_name_key                                  | name                       |
| migrations                 | migrations_pkey                                      | id                         |
| oauth_authorizations       | oauth_auth_pending_exp_idx                           | expires_at                 |
| oauth_authorizations       | oauth_authorizations_authorization_code_key          | authorization_code         |
| oauth_authorizations       | oauth_authorizations_authorization_id_key            | authorization_id           |
| oauth_authorizations       | oauth_authorizations_pkey                            | id                         |
| oauth_clients              | oauth_clients_deleted_at_idx                         | deleted_at                 |
| oauth_clients              | oauth_clients_pkey                                   | id                         |
| oauth_consents             | oauth_consents_active_client_idx                     | client_id                  |
| oauth_consents             | oauth_consents_active_user_client_idx                | client_id                  |
| oauth_consents             | oauth_consents_active_user_client_idx                | user_id                    |
| oauth_consents             | oauth_consents_pkey                                  | id                         |
| oauth_consents             | oauth_consents_user_client_unique                    | user_id                    |
| oauth_consents             | oauth_consents_user_client_unique                    | client_id                  |
| oauth_consents             | oauth_consents_user_order_idx                        | granted_at                 |
| oauth_consents             | oauth_consents_user_order_idx                        | user_id                    |
| objects                    | bucketid_objname                                     | bucket_id                  |
| objects                    | bucketid_objname                                     | name                       |
| objects                    | idx_name_bucket_level_unique                         | name                       |
| objects                    | idx_name_bucket_level_unique                         | bucket_id                  |
| objects                    | idx_name_bucket_level_unique                         | level                      |
| objects                    | idx_objects_bucket_id_name                           | name                       |
| objects                    | idx_objects_bucket_id_name                           | bucket_id                  |
| objects                    | idx_objects_lower_name                               | bucket_id                  |
| objects                    | idx_objects_lower_name                               | level                      |
| objects                    | name_prefix_search                                   | name                       |
| objects                    | objects_bucket_id_level_idx                          | bucket_id                  |
| objects                    | objects_bucket_id_level_idx                          | name                       |
| objects                    | objects_bucket_id_level_idx                          | level                      |
| objects                    | objects_pkey                                         | id                         |
| one_time_tokens            | one_time_tokens_pkey                                 | id                         |
| one_time_tokens            | one_time_tokens_relates_to_hash_idx                  | relates_to                 |
| one_time_tokens            | one_time_tokens_token_hash_hash_idx                  | token_hash                 |
| one_time_tokens            | one_time_tokens_user_id_token_type_key               | user_id                    |
| one_time_tokens            | one_time_tokens_user_id_token_type_key               | token_type                 |
| orders                     | idx_orders_payment_status                            | payment_status             |
| orders                     | idx_orders_stripe_payment_intent                     | stripe_payment_intent_id   |
| orders                     | idx_orders_user_id                                   | user_id                    |
| orders                     | orders_pkey                                          | id                         |
| pg_aggregate               | pg_aggregate_fnoid_index                             | aggfnoid                   |
| pg_am                      | pg_am_name_index                                     | amname                     |
| pg_am                      | pg_am_oid_index                                      | oid                        |
| pg_amop                    | pg_amop_fam_strat_index                              | amoprighttype              |
| pg_amop                    | pg_amop_fam_strat_index                              | amoplefttype               |
| pg_amop                    | pg_amop_fam_strat_index                              | amopstrategy               |
| pg_amop                    | pg_amop_fam_strat_index                              | amopfamily                 |
| pg_amop                    | pg_amop_oid_index                                    | oid                        |
| pg_amop                    | pg_amop_opr_fam_index                                | amopopr                    |
| pg_amop                    | pg_amop_opr_fam_index                                | amoppurpose                |
| pg_amop                    | pg_amop_opr_fam_index                                | amopfamily                 |
| pg_amproc                  | pg_amproc_fam_proc_index                             | amprocfamily               |
| pg_amproc                  | pg_amproc_fam_proc_index                             | amproclefttype             |
| pg_amproc                  | pg_amproc_fam_proc_index                             | amprocnum                  |
| pg_amproc                  | pg_amproc_fam_proc_index                             | amprocrighttype            |
| pg_amproc                  | pg_amproc_oid_index                                  | oid                        |
| pg_attrdef                 | pg_attrdef_adrelid_adnum_index                       | adnum                      |
| pg_attrdef                 | pg_attrdef_adrelid_adnum_index                       | adrelid                    |
| pg_attrdef                 | pg_attrdef_oid_index                                 | oid                        |
| pg_attribute               | pg_attribute_relid_attnam_index                      | attname                    |
| pg_attribute               | pg_attribute_relid_attnam_index                      | attrelid                   |
| pg_attribute               | pg_attribute_relid_attnum_index                      | attrelid                   |
| pg_attribute               | pg_attribute_relid_attnum_index                      | attnum                     |
| pg_auth_members            | pg_auth_members_grantor_index                        | grantor                    |
| pg_auth_members            | pg_auth_members_member_role_index                    | grantor                    |
| pg_auth_members            | pg_auth_members_member_role_index                    | roleid                     |
| pg_auth_members            | pg_auth_members_member_role_index                    | member                     |
| pg_auth_members            | pg_auth_members_oid_index                            | oid                        |
| pg_auth_members            | pg_auth_members_role_member_index                    | roleid                     |
| pg_auth_members            | pg_auth_members_role_member_index                    | grantor                    |
| pg_auth_members            | pg_auth_members_role_member_index                    | member                     |
| pg_authid                  | pg_authid_oid_index                                  | oid                        |
| pg_authid                  | pg_authid_rolname_index                              | rolname                    |
| pg_cast                    | pg_cast_oid_index                                    | oid                        |
| pg_cast                    | pg_cast_source_target_index                          | casttarget                 |
| pg_cast                    | pg_cast_source_target_index                          | castsource                 |
| pg_class                   | pg_class_oid_index                                   | oid                        |
| pg_class                   | pg_class_relname_nsp_index                           | relnamespace               |
| pg_class                   | pg_class_relname_nsp_index                           | relname                    |
| pg_class                   | pg_class_tblspc_relfilenode_index                    | reltablespace              |
| pg_class                   | pg_class_tblspc_relfilenode_index                    | relfilenode                |
| pg_collation               | pg_collation_name_enc_nsp_index                      | collnamespace              |
| pg_collation               | pg_collation_name_enc_nsp_index                      | collname                   |
| pg_collation               | pg_collation_name_enc_nsp_index                      | collencoding               |
| pg_collation               | pg_collation_oid_index                               | oid                        |
| pg_constraint              | pg_constraint_conname_nsp_index                      | conname                    |
| pg_constraint              | pg_constraint_conname_nsp_index                      | connamespace               |
| pg_constraint              | pg_constraint_conparentid_index                      | conparentid                |
| pg_constraint              | pg_constraint_conrelid_contypid_conname_index        | conname                    |
| pg_constraint              | pg_constraint_conrelid_contypid_conname_index        | contypid                   |
| pg_constraint              | pg_constraint_conrelid_contypid_conname_index        | conrelid                   |
| pg_constraint              | pg_constraint_contypid_index                         | contypid                   |
| pg_constraint              | pg_constraint_oid_index                              | oid                        |
| pg_conversion              | pg_conversion_default_index                          | contoencoding              |
| pg_conversion              | pg_conversion_default_index                          | conforencoding             |
| pg_conversion              | pg_conversion_default_index                          | connamespace               |
| pg_conversion              | pg_conversion_default_index                          | oid                        |
| pg_conversion              | pg_conversion_name_nsp_index                         | conname                    |
| pg_conversion              | pg_conversion_name_nsp_index                         | connamespace               |
| pg_conversion              | pg_conversion_oid_index                              | oid                        |
| pg_database                | pg_database_datname_index                            | datname                    |
| pg_database                | pg_database_oid_index                                | oid                        |
| pg_db_role_setting         | pg_db_role_setting_databaseid_rol_index              | setrole                    |
| pg_db_role_setting         | pg_db_role_setting_databaseid_rol_index              | setdatabase                |
| pg_default_acl             | pg_default_acl_oid_index                             | oid                        |
| pg_default_acl             | pg_default_acl_role_nsp_obj_index                    | defaclobjtype              |
| pg_default_acl             | pg_default_acl_role_nsp_obj_index                    | defaclnamespace            |
| pg_default_acl             | pg_default_acl_role_nsp_obj_index                    | defaclrole                 |
| pg_depend                  | pg_depend_depender_index                             | objid                      |
| pg_depend                  | pg_depend_depender_index                             | objsubid                   |
| pg_depend                  | pg_depend_depender_index                             | classid                    |
| pg_depend                  | pg_depend_reference_index                            | refclassid                 |
| pg_depend                  | pg_depend_reference_index                            | refobjid                   |
| pg_depend                  | pg_depend_reference_index                            | refobjsubid                |
| pg_description             | pg_description_o_c_o_index                           | objsubid                   |
| pg_description             | pg_description_o_c_o_index                           | classoid                   |
| pg_description             | pg_description_o_c_o_index                           | objoid                     |
| pg_enum                    | pg_enum_oid_index                                    | oid                        |
| pg_enum                    | pg_enum_typid_label_index                            | enumtypid                  |
| pg_enum                    | pg_enum_typid_label_index                            | enumlabel                  |
| pg_enum                    | pg_enum_typid_sortorder_index                        | enumsortorder              |
| pg_enum                    | pg_enum_typid_sortorder_index                        | enumtypid                  |
| pg_event_trigger           | pg_event_trigger_evtname_index                       | evtname                    |
| pg_event_trigger           | pg_event_trigger_oid_index                           | oid                        |
| pg_extension               | pg_extension_name_index                              | extname                    |
| pg_extension               | pg_extension_oid_index                               | oid                        |
| pg_foreign_data_wrapper    | pg_foreign_data_wrapper_name_index                   | fdwname                    |
| pg_foreign_data_wrapper    | pg_foreign_data_wrapper_oid_index                    | oid                        |
| pg_foreign_server          | pg_foreign_server_name_index                         | srvname                    |
| pg_foreign_server          | pg_foreign_server_oid_index                          | oid                        |
| pg_foreign_table           | pg_foreign_table_relid_index                         | ftrelid                    |
| pg_index                   | pg_index_indexrelid_index                            | indexrelid                 |
| pg_index                   | pg_index_indrelid_index                              | indrelid                   |
| pg_inherits                | pg_inherits_parent_index                             | inhparent                  |
| pg_inherits                | pg_inherits_relid_seqno_index                        | inhrelid                   |
| pg_inherits                | pg_inherits_relid_seqno_index                        | inhseqno                   |
| pg_init_privs              | pg_init_privs_o_c_o_index                            | objoid                     |
| pg_init_privs              | pg_init_privs_o_c_o_index                            | objsubid                   |
| pg_init_privs              | pg_init_privs_o_c_o_index                            | classoid                   |
| pg_language                | pg_language_name_index                               | lanname                    |
| pg_language                | pg_language_oid_index                                | oid                        |
| pg_largeobject             | pg_largeobject_loid_pn_index                         | loid                       |
| pg_largeobject             | pg_largeobject_loid_pn_index                         | pageno                     |
| pg_largeobject_metadata    | pg_largeobject_metadata_oid_index                    | oid                        |
| pg_namespace               | pg_namespace_nspname_index                           | nspname                    |
| pg_namespace               | pg_namespace_oid_index                               | oid                        |
| pg_opclass                 | pg_opclass_am_name_nsp_index                         | opcmethod                  |
| pg_opclass                 | pg_opclass_am_name_nsp_index                         | opcnamespace               |
| pg_opclass                 | pg_opclass_am_name_nsp_index                         | opcname                    |
| pg_opclass                 | pg_opclass_oid_index                                 | oid                        |
| pg_operator                | pg_operator_oid_index                                | oid                        |
| pg_operator                | pg_operator_oprname_l_r_n_index                      | oprright                   |
| pg_operator                | pg_operator_oprname_l_r_n_index                      | oprname                    |
| pg_operator                | pg_operator_oprname_l_r_n_index                      | oprnamespace               |
| pg_operator                | pg_operator_oprname_l_r_n_index                      | oprleft                    |
| pg_opfamily                | pg_opfamily_am_name_nsp_index                        | opfname                    |
| pg_opfamily                | pg_opfamily_am_name_nsp_index                        | opfmethod                  |
| pg_opfamily                | pg_opfamily_am_name_nsp_index                        | opfnamespace               |
| pg_opfamily                | pg_opfamily_oid_index                                | oid                        |
| pg_parameter_acl           | pg_parameter_acl_oid_index                           | oid                        |
| pg_parameter_acl           | pg_parameter_acl_parname_index                       | parname                    |
| pg_partitioned_table       | pg_partitioned_table_partrelid_index                 | partrelid                  |
| pg_policy                  | pg_policy_oid_index                                  | oid                        |
| pg_policy                  | pg_policy_polrelid_polname_index                     | polrelid                   |
| pg_policy                  | pg_policy_polrelid_polname_index                     | polname                    |
| pg_proc                    | pg_proc_oid_index                                    | oid                        |
| pg_proc                    | pg_proc_proname_args_nsp_index                       | proargtypes                |
| pg_proc                    | pg_proc_proname_args_nsp_index                       | proname                    |
| pg_proc                    | pg_proc_proname_args_nsp_index                       | pronamespace               |
| pg_publication             | pg_publication_oid_index                             | oid                        |
| pg_publication             | pg_publication_pubname_index                         | pubname                    |
| pg_publication_namespace   | pg_publication_namespace_oid_index                   | oid                        |
| pg_publication_namespace   | pg_publication_namespace_pnnspid_pnpubid_index       | pnpubid                    |
| pg_publication_namespace   | pg_publication_namespace_pnnspid_pnpubid_index       | pnnspid                    |
| pg_publication_rel         | pg_publication_rel_oid_index                         | oid                        |
| pg_publication_rel         | pg_publication_rel_prpubid_index                     | prpubid                    |
| pg_publication_rel         | pg_publication_rel_prrelid_prpubid_index             | prpubid                    |
| pg_publication_rel         | pg_publication_rel_prrelid_prpubid_index             | prrelid                    |
| pg_range                   | pg_range_rngmultitypid_index                         | rngmultitypid              |
| pg_range                   | pg_range_rngtypid_index                              | rngtypid                   |
| pg_replication_origin      | pg_replication_origin_roiident_index                 | roident                    |
| pg_replication_origin      | pg_replication_origin_roname_index                   | roname                     |
| pg_rewrite                 | pg_rewrite_oid_index                                 | oid                        |
| pg_rewrite                 | pg_rewrite_rel_rulename_index                        | rulename                   |
| pg_rewrite                 | pg_rewrite_rel_rulename_index                        | ev_class                   |
| pg_seclabel                | pg_seclabel_object_index                             | objsubid                   |
| pg_seclabel                | pg_seclabel_object_index                             | classoid                   |
| pg_seclabel                | pg_seclabel_object_index                             | objoid                     |
| pg_seclabel                | pg_seclabel_object_index                             | provider                   |
| pg_sequence                | pg_sequence_seqrelid_index                           | seqrelid                   |
| pg_shdepend                | pg_shdepend_depender_index                           | objsubid                   |
| pg_shdepend                | pg_shdepend_depender_index                           | objid                      |
| pg_shdepend                | pg_shdepend_depender_index                           | dbid                       |
| pg_shdepend                | pg_shdepend_depender_index                           | classid                    |
| pg_shdepend                | pg_shdepend_reference_index                          | refobjid                   |
| pg_shdepend                | pg_shdepend_reference_index                          | refclassid                 |
| pg_shdescription           | pg_shdescription_o_c_index                           | classoid                   |
| pg_shdescription           | pg_shdescription_o_c_index                           | objoid                     |
| pg_shseclabel              | pg_shseclabel_object_index                           | classoid                   |
| pg_shseclabel              | pg_shseclabel_object_index                           | provider                   |
| pg_shseclabel              | pg_shseclabel_object_index                           | objoid                     |
| pg_statistic               | pg_statistic_relid_att_inh_index                     | starelid                   |
| pg_statistic               | pg_statistic_relid_att_inh_index                     | stainherit                 |
| pg_statistic               | pg_statistic_relid_att_inh_index                     | staattnum                  |
| pg_statistic_ext           | pg_statistic_ext_name_index                          | stxnamespace               |
| pg_statistic_ext           | pg_statistic_ext_name_index                          | stxname                    |
| pg_statistic_ext           | pg_statistic_ext_oid_index                           | oid                        |
| pg_statistic_ext           | pg_statistic_ext_relid_index                         | stxrelid                   |
| pg_statistic_ext_data      | pg_statistic_ext_data_stxoid_inh_index               | stxdinherit                |
| pg_statistic_ext_data      | pg_statistic_ext_data_stxoid_inh_index               | stxoid                     |
| pg_subscription            | pg_subscription_oid_index                            | oid                        |
| pg_subscription            | pg_subscription_subname_index                        | subdbid                    |
| pg_subscription            | pg_subscription_subname_index                        | subname                    |
| pg_subscription_rel        | pg_subscription_rel_srrelid_srsubid_index            | srsubid                    |
| pg_subscription_rel        | pg_subscription_rel_srrelid_srsubid_index            | srrelid                    |
| pg_tablespace              | pg_tablespace_oid_index                              | oid                        |
| pg_tablespace              | pg_tablespace_spcname_index                          | spcname                    |
| pg_toast_1213              | pg_toast_1213_index                                  | chunk_id                   |
| pg_toast_1213              | pg_toast_1213_index                                  | chunk_seq                  |
| pg_toast_1247              | pg_toast_1247_index                                  | chunk_seq                  |
| pg_toast_1247              | pg_toast_1247_index                                  | chunk_id                   |
| pg_toast_1255              | pg_toast_1255_index                                  | chunk_id                   |
| pg_toast_1255              | pg_toast_1255_index                                  | chunk_seq                  |
| pg_toast_1260              | pg_toast_1260_index                                  | chunk_seq                  |
| pg_toast_1260              | pg_toast_1260_index                                  | chunk_id                   |
| pg_toast_1262              | pg_toast_1262_index                                  | chunk_id                   |
| pg_toast_1262              | pg_toast_1262_index                                  | chunk_seq                  |
| pg_toast_13402             | pg_toast_13402_index                                 | chunk_id                   |
| pg_toast_13402             | pg_toast_13402_index                                 | chunk_seq                  |
| pg_toast_13407             | pg_toast_13407_index                                 | chunk_id                   |
| pg_toast_13407             | pg_toast_13407_index                                 | chunk_seq                  |
| pg_toast_13412             | pg_toast_13412_index                                 | chunk_seq                  |
| pg_toast_13412             | pg_toast_13412_index                                 | chunk_id                   |
| pg_toast_13417             | pg_toast_13417_index                                 | chunk_seq                  |
| pg_toast_13417             | pg_toast_13417_index                                 | chunk_id                   |
| pg_toast_1417              | pg_toast_1417_index                                  | chunk_seq                  |
| pg_toast_1417              | pg_toast_1417_index                                  | chunk_id                   |
| pg_toast_1418              | pg_toast_1418_index                                  | chunk_seq                  |
| pg_toast_1418              | pg_toast_1418_index                                  | chunk_id                   |
| pg_toast_16495             | pg_toast_16495_index                                 | chunk_seq                  |
| pg_toast_16495             | pg_toast_16495_index                                 | chunk_id                   |
| pg_toast_16507             | pg_toast_16507_index                                 | chunk_seq                  |
| pg_toast_16507             | pg_toast_16507_index                                 | chunk_id                   |
| pg_toast_16518             | pg_toast_16518_index                                 | chunk_seq                  |
| pg_toast_16518             | pg_toast_16518_index                                 | chunk_id                   |
| pg_toast_16525             | pg_toast_16525_index                                 | chunk_seq                  |
| pg_toast_16525             | pg_toast_16525_index                                 | chunk_id                   |
| pg_toast_16546             | pg_toast_16546_index                                 | chunk_id                   |
| pg_toast_16546             | pg_toast_16546_index                                 | chunk_seq                  |
| pg_toast_16561             | pg_toast_16561_index                                 | chunk_seq                  |
| pg_toast_16561             | pg_toast_16561_index                                 | chunk_id                   |
| pg_toast_16658             | pg_toast_16658_index                                 | chunk_id                   |
| pg_toast_16658             | pg_toast_16658_index                                 | chunk_seq                  |
| pg_toast_16727             | pg_toast_16727_index                                 | chunk_id                   |
| pg_toast_16727             | pg_toast_16727_index                                 | chunk_seq                  |
| pg_toast_16757             | pg_toast_16757_index                                 | chunk_seq                  |
| pg_toast_16757             | pg_toast_16757_index                                 | chunk_id                   |
| pg_toast_16791             | pg_toast_16791_index                                 | chunk_seq                  |
| pg_toast_16791             | pg_toast_16791_index                                 | chunk_id                   |
| pg_toast_16804             | pg_toast_16804_index                                 | chunk_id                   |
| pg_toast_16804             | pg_toast_16804_index                                 | chunk_seq                  |
| pg_toast_16816             | pg_toast_16816_index                                 | chunk_seq                  |
| pg_toast_16816             | pg_toast_16816_index                                 | chunk_id                   |
| pg_toast_16834             | pg_toast_16834_index                                 | chunk_id                   |
| pg_toast_16834             | pg_toast_16834_index                                 | chunk_seq                  |
| pg_toast_16843             | pg_toast_16843_index                                 | chunk_seq                  |
| pg_toast_16843             | pg_toast_16843_index                                 | chunk_id                   |
| pg_toast_16858             | pg_toast_16858_index                                 | chunk_id                   |
| pg_toast_16858             | pg_toast_16858_index                                 | chunk_seq                  |
| pg_toast_16876             | pg_toast_16876_index                                 | chunk_seq                  |
| pg_toast_16876             | pg_toast_16876_index                                 | chunk_id                   |
| pg_toast_16929             | pg_toast_16929_index                                 | chunk_seq                  |
| pg_toast_16929             | pg_toast_16929_index                                  | chunk_id                   |
| pg_toast_16979             | pg_toast_16979_index                                 | chunk_id                   |
| pg_toast_16979             | pg_toast_16979_index                                 | chunk_seq                  |
| pg_toast_17011             | pg_toast_17011_index                                 | chunk_id                   |
| pg_toast_17011             | pg_toast_17011_index                                 | chunk_seq                  |
| pg_toast_17041             | pg_toast_17041_index                                 | chunk_seq                  |
| pg_toast_17041             | pg_toast_17041_index                                 | chunk_id                   |
| pg_toast_17074             | pg_toast_17074_index                                 | chunk_seq                  |
| pg_toast_17074             | pg_toast_17074_index                                 | chunk_id                   |
| pg_toast_17144             | pg_toast_17144_index                                 | chunk_seq                  |
| pg_toast_17144             | pg_toast_17144_index                                 | chunk_id                   |
| pg_toast_17158             | pg_toast_17158_index                                 | chunk_seq                  |
| pg_toast_17158             | pg_toast_17158_index                                 | chunk_id                   |
| pg_toast_17197             | pg_toast_17197_index                                 | chunk_id                   |
| pg_toast_17197             | pg_toast_17197_index                                 | chunk_seq                  |
| pg_toast_17242             | pg_toast_17242_index                                 | chunk_id                   |
| pg_toast_17242             | pg_toast_17242_index                                 | chunk_seq                  |
| pg_toast_17269             | pg_toast_17269_index                                 | chunk_seq                  |
| pg_toast_17269             | pg_toast_17269_index                                 | chunk_id                   |
| pg_toast_17279             | pg_toast_17279_index                                 | chunk_seq                  |
| pg_toast_17279             | pg_toast_17279_index                                 | chunk_id                   |
| pg_toast_17331             | pg_toast_17331_index                                 | chunk_id                   |
| pg_toast_17331             | pg_toast_17331_index                                 | chunk_seq                  |
| pg_toast_17488             | pg_toast_17488_index                                 | chunk_id                   |
| pg_toast_17488             | pg_toast_17488_index                                 | chunk_seq                  |
| pg_toast_17512             | pg_toast_17512_index                                 | chunk_id                   |
| pg_toast_17512             | pg_toast_17512_index                                 | chunk_seq                  |
| pg_toast_17541             | pg_toast_17541_index                                 | chunk_seq                  |
| pg_toast_17541             | pg_toast_17541_index                                 | chunk_id                   |
| pg_toast_17571             | pg_toast_17571_index                                 | chunk_id                   |
| pg_toast_17571             | pg_toast_17571_index                                 | chunk_seq                  |
| pg_toast_17599             | pg_toast_17599_index                                 | chunk_seq                  |
| pg_toast_17599             | pg_toast_17599_index                                 | chunk_id                   |
| pg_toast_17626             | pg_toast_17626_index                                 | chunk_id                   |
| pg_toast_17626             | pg_toast_17626_index                                 | chunk_seq                  |
| pg_toast_17655             | pg_toast_17655_index                                 | chunk_seq                  |
| pg_toast_17655             | pg_toast_17655_index                                 | chunk_id                   |
| pg_toast_17685             | pg_toast_17685_index                                 | chunk_id                   |
| pg_toast_17685             | pg_toast_17685_index                                 | chunk_seq                  |
| pg_toast_17711             | pg_toast_17711_index                                 | chunk_seq                  |
| pg_toast_17711             | pg_toast_17711_index                                 | chunk_id                   |
| pg_toast_17744             | pg_toast_17744_index                                 | chunk_id                   |
| pg_toast_17744             | pg_toast_17744_index                                 | chunk_seq                  |
| pg_toast_17795             | pg_toast_17795_index                                 | chunk_seq                  |
| pg_toast_17795             | pg_toast_17795_index                                 | chunk_id                   |
| pg_toast_18982             | pg_toast_18982_index                                 | chunk_seq                  |
| pg_toast_18982             | pg_toast_18982_index                                 | chunk_id                   |
| pg_toast_19038             | pg_toast_19038_index                                 | chunk_seq                  |
| pg_toast_19038             | pg_toast_19038_index                                 | chunk_id                   |
| pg_toast_19072             | pg_toast_19072_index                                 | chunk_id                   |
| pg_toast_19072             | pg_toast_19072_index                                 | chunk_seq                  |
| pg_toast_19100             | pg_toast_19100_index                                 | chunk_seq                  |
| pg_toast_19100             | pg_toast_19100_index                                 | chunk_id                   |
| pg_toast_19123             | pg_toast_19123_index                                 | chunk_seq                  |
| pg_toast_19123             | pg_toast_19123_index                                 | chunk_id                   |
| pg_toast_19146             | pg_toast_19146_index                                 | chunk_seq                  |
| pg_toast_19146             | pg_toast_19146_index                                 | chunk_id                   |
| pg_toast_19178             | pg_toast_19178_index                                 | chunk_seq                  |
| pg_toast_19178             | pg_toast_19178_index                                 | chunk_id                   |
| pg_toast_21560             | pg_toast_21560_index                                 | chunk_seq                  |
| pg_toast_21560             | pg_toast_21560_index                                 | chunk_id                   |
| pg_toast_21626             | pg_toast_21626_index                                 | chunk_seq                  |
| pg_toast_21626             | pg_toast_21626_index                                 | chunk_id                   |
| pg_toast_2328              | pg_toast_2328_index                                  | chunk_seq                  |
| pg_toast_2328              | pg_toast_2328_index                                  | chunk_id                   |
| pg_toast_2396              | pg_toast_2396_index                                  | chunk_seq                  |
| pg_toast_2396              | pg_toast_2396_index                                  | chunk_id                   |
| pg_toast_2600              | pg_toast_2600_index                                  | chunk_seq                  |
| pg_toast_2600              | pg_toast_2600_index                                  | chunk_id                   |
| pg_toast_2604              | pg_toast_2604_index                                  | chunk_seq                  |
| pg_toast_2604              | pg_toast_2604_index                                  | chunk_id                   |
| pg_toast_2606              | pg_toast_2606_index                                  | chunk_seq                  |
| pg_toast_2606              | pg_toast_2606_index                                  | chunk_id                   |
| pg_toast_2609              | pg_toast_2609_index                                  | chunk_seq                  |
| pg_toast_2609              | pg_toast_2609_index                                  | chunk_id                   |
| pg_toast_2612              | pg_toast_2612_index                                  | chunk_seq                  |
| pg_toast_2612              | pg_toast_2612_index                                  | chunk_id                   |
| pg_toast_2615              | pg_toast_2615_index                                  | chunk_id                   |
| pg_toast_2615              | pg_toast_2615_index                                  | chunk_seq                  |
| pg_toast_2618              | pg_toast_2618_index                                  | chunk_id                   |
| pg_toast_2618              | pg_toast_2618_index                                  | chunk_seq                  |
| pg_toast_2619              | pg_toast_2619_index                                  | chunk_seq                  |
| pg_toast_2619              | pg_toast_2619_index                                  | chunk_id                   |
| pg_toast_2620              | pg_toast_2620_index                                  | chunk_seq                  |
| pg_toast_2620              | pg_toast_2620_index                                  | chunk_id                   |
| pg_toast_2964              | pg_toast_2964_index                                  | chunk_id                   |
| pg_toast_2964              | pg_toast_2964_index                                  | chunk_seq                  |
| pg_toast_3079              | pg_toast_3079_index                                  | chunk_seq                  |
| pg_toast_3079              | pg_toast_3079_index                                  | chunk_id                   |
| pg_toast_3118              | pg_toast_3118_index                                  | chunk_seq                  |
| pg_toast_3118              | pg_toast_3118_index                                  | chunk_id                   |
| pg_toast_3256              | pg_toast_3256_index                                  | chunk_seq                  |
| pg_toast_3256              | pg_toast_3256_index                                  | chunk_id                   |
| pg_toast_3350              | pg_toast_3350_index                                  | chunk_seq                  |
| pg_toast_3350              | pg_toast_3350_index                                  | chunk_id                   |
| pg_toast_3381              | pg_toast_3381_index                                  | chunk_seq                  |
| pg_toast_3381              | pg_toast_3381_index                                  | chunk_id                   |
| pg_toast_3394              | pg_toast_3394_index                                  | chunk_id                   |
| pg_toast_3394              | pg_toast_3394_index                                  | chunk_seq                  |
| pg_toast_3429              | pg_toast_3429_index                                  | chunk_id                   |
| pg_toast_3429              | pg_toast_3429_index                                  | chunk_seq                  |
| pg_toast_3456              | pg_toast_3456_index                                  | chunk_seq                  |
| pg_toast_3456              | pg_toast_3456_index                                  | chunk_id                   |
| pg_toast_3466              | pg_toast_3466_index                                  | chunk_seq                  |
| pg_toast_3466              | pg_toast_3466_index                                  | chunk_id                   |
| pg_toast_3592              | pg_toast_3592_index                                  | chunk_id                   |
| pg_toast_3592              | pg_toast_3592_index                                  | chunk_seq                  |
| pg_toast_3596              | pg_toast_3596_index                                  | chunk_seq                  |
| pg_toast_3596              | pg_toast_3596_index                                  | chunk_id                   |
| pg_toast_3600              | pg_toast_3600_index                                  | chunk_id                   |
| pg_toast_3600              | pg_toast_3600_index                                  | chunk_seq                  |
| pg_toast_6000              | pg_toast_6000_index                                  | chunk_seq                  |
| pg_toast_6000              | pg_toast_6000_index                                  | chunk_id                   |
| pg_toast_6100              | pg_toast_6100_index                                  | chunk_seq                  |
| pg_toast_6100              | pg_toast_6100_index                                  | chunk_id                   |
| pg_toast_6106              | pg_toast_6106_index                                  | chunk_id                   |
| pg_toast_6106              | pg_toast_6106_index                                  | chunk_seq                  |
| pg_toast_6243              | pg_toast_6243_index                                  | chunk_id                   |
| pg_toast_6243              | pg_toast_6243_index                                  | chunk_seq                  |
| pg_toast_826               | pg_toast_826_index                                   | chunk_seq                  |
| pg_toast_826               | pg_toast_826_index                                   | chunk_id                   |
| pg_transform               | pg_transform_oid_index                               | oid                        |
| pg_transform               | pg_transform_type_lang_index                         | trflang                    |
| pg_transform               | pg_transform_type_lang_index                         | trftype                    |
| pg_trigger                 | pg_trigger_oid_index                                 | oid                        |
| pg_trigger                 | pg_trigger_tgconstraint_index                        | tgconstraint               |
| pg_trigger                 | pg_trigger_tgrelid_tgname_index                      | tgname                     |
| pg_trigger                 | pg_trigger_tgrelid_tgname_index                      | tgrelid                    |
| pg_ts_config               | pg_ts_config_cfgname_index                           | cfgnamespace               |
| pg_ts_config               | pg_ts_config_cfgname_index                           | cfgname                    |
| pg_ts_config               | pg_ts_config_oid_index                               | oid                        |
| pg_ts_config_map           | pg_ts_config_map_index                               | mapseqno                   |
| pg_ts_config_map           | pg_ts_config_map_index                               | maptokentype               |
| pg_ts_config_map           | pg_ts_config_map_index                               | mapcfg                     |
| pg_ts_dict                 | pg_ts_dict_dictname_index                            | dictname                   |
| pg_ts_dict                 | pg_ts_dict_dictname_index                            | dictnamespace              |
| pg_ts_dict                 | pg_ts_dict_oid_index                                 | oid                        |
| pg_ts_parser               | pg_ts_parser_oid_index                               | oid                        |
| pg_ts_parser               | pg_ts_parser_prsname_index                           | prsname                    |
| pg_ts_parser               | pg_ts_parser_prsname_index                           | prsnamespace               |
| pg_ts_template             | pg_ts_template_oid_index                             | oid                        |
| pg_ts_template             | pg_ts_template_tmplname_index                        | tmplnamespace              |
| pg_ts_template             | pg_ts_template_tmplname_index                        | tmplname                   |
| pg_type                    | pg_type_oid_index                                    | oid                        |
| pg_type                    | pg_type_typname_nsp_index                            | typname                    |
| pg_type                    | pg_type_typname_nsp_index                            | typnamespace               |
| pg_user_mapping            | pg_user_mapping_oid_index                            | oid                        |
| pg_user_mapping            | pg_user_mapping_user_server_index                    | umuser                     |
| pg_user_mapping            | pg_user_mapping_user_server_index                    | umserver                   |
| prefixes                   | idx_prefixes_lower_name                              | level                      |
| prefixes                   | idx_prefixes_lower_name                              | bucket_id                  |
| prefixes                   | prefixes_pkey                                        | bucket_id                  |
| prefixes                   | prefixes_pkey                                        | level                      |
| prefixes                   | prefixes_pkey                                        | name                       |
| refresh_tokens             | refresh_tokens_instance_id_idx                       | instance_id                |
| refresh_tokens             | refresh_tokens_instance_id_user_id_idx               | user_id                    |
| refresh_tokens             | refresh_tokens_instance_id_user_id_idx               | instance_id                |
| refresh_tokens             | refresh_tokens_parent_idx                            | parent                     |
| refresh_tokens             | refresh_tokens_pkey                                  | id                         |
| refresh_tokens             | refresh_tokens_session_id_revoked_idx                | session_id                 |
| refresh_tokens             | refresh_tokens_session_id_revoked_idx                | revoked                    |
| refresh_tokens             | refresh_tokens_token_unique                          | token                      |
| refresh_tokens             | refresh_tokens_updated_at_idx                        | updated_at                 |
| s3_multipart_uploads       | idx_multipart_uploads_list                           | bucket_id                  |
| s3_multipart_uploads       | idx_multipart_uploads_list                           | key                        |
| s3_multipart_uploads       | idx_multipart_uploads_list                           | created_at                 |
| s3_multipart_uploads       | s3_multipart_uploads_pkey                            | id                         |
| s3_multipart_uploads_parts | s3_multipart_uploads_parts_pkey                      | id                         |
| saml_providers             | saml_providers_entity_id_key                         | entity_id                  |
| saml_providers             | saml_providers_pkey                                  | id                         |
| saml_providers             | saml_providers_sso_provider_id_idx                   | sso_provider_id            |
| saml_relay_states          | saml_relay_states_created_at_idx                     | created_at                 |
| saml_relay_states          | saml_relay_states_for_email_idx                      | for_email                  |
| saml_relay_states          | saml_relay_states_pkey                               | id                         |
| saml_relay_states          | saml_relay_states_sso_provider_id_idx                | sso_provider_id            |
| schema_migrations          | schema_migrations_pkey                               | version                    |
| schema_migrations          | schema_migrations_pkey                               | version                    |
| secrets                    | secrets_name_idx                                     | name                       |
| secrets                    | secrets_pkey                                         | id                         |
| seo_automation_log         | idx_seo_automation_log_date                          | created_at                 |
| seo_automation_log         | idx_seo_automation_log_status                        | status                     |
| seo_automation_log         | idx_seo_automation_log_task                          | task_type                  |
| seo_automation_log         | seo_automation_log_pkey                              | id                         |
| seo_backlinks              | idx_seo_backlinks_acquired                           | acquired                   |
| seo_backlinks              | idx_seo_backlinks_domain                             | target_domain              |
| seo_backlinks              | idx_seo_backlinks_status                             | outreach_status            |
| seo_backlinks              | seo_backlinks_pkey                                   | id                         |
| seo_content_queue          | idx_seo_content_queue_priority                       | priority                   |
| seo_content_queue          | idx_seo_content_queue_scheduled                      | scheduled_for              |
| seo_content_queue          | idx_seo_content_queue_status                         | status                     |
| seo_content_queue          | seo_content_queue_pkey                               | id                         |
| seo_keywords               | idx_seo_keywords_keyword                             | keyword                    |
| seo_keywords               | idx_seo_keywords_priority                            | priority                   |
| seo_keywords               | idx_seo_keywords_status                              | status                     |
| seo_keywords               | seo_keywords_keyword_key                             | keyword                    |
| seo_keywords               | seo_keywords_pkey                                    | id                         |
| seo_pages                  | idx_seo_pages_keyword                                | target_keyword             |
| seo_pages                  | idx_seo_pages_location                               | location                   |
| seo_pages                  | idx_seo_pages_published                              | published_at               |
| seo_pages                  | idx_seo_pages_slug                                   | slug                       |
| seo_pages                  | idx_seo_pages_status                                 | status                     |
| seo_pages                  | seo_pages_pkey                                       | id                         |
| seo_pages                  | seo_pages_slug_key                                   | slug                       |
| seo_performance            | idx_seo_performance_date                             | date                       |
| seo_performance            | idx_seo_performance_page                             | page_id                    |
| seo_performance            | seo_performance_date_page_id_key                     | date                       |
| seo_performance            | seo_performance_date_page_id_key                     | page_id                    |
| seo_performance            | seo_performance_pkey                                 | id                         |
| sessions                   | sessions_not_after_idx                               | not_after                  |
| sessions                   | sessions_oauth_client_id_idx                         | oauth_client_id            |
| sessions                   | sessions_pkey                                        | id                         |
| sessions                   | sessions_user_id_idx                                 | user_id                    |
| sessions                   | user_id_created_at_idx                               | user_id                    |
| sessions                   | user_id_created_at_idx                               | created_at                 |
| sso_domains                | sso_domains_pkey                                     | id                         |
| sso_domains                | sso_domains_sso_provider_id_idx                      | sso_provider_id            |
| sso_providers              | sso_providers_pkey                                   | id                         |
| sso_providers              | sso_providers_resource_id_pattern_idx                | resource_id                |
| subscription               | ix_realtime_subscription_entity                      | entity                     |
| subscription               | pk_subscription                                      | id                         |
| subscription               | subscription_subscription_id_entity_filters_key      | entity                     |
| subscription               | subscription_subscription_id_entity_filters_key      | subscription_id            |
| subscription               | subscription_subscription_id_entity_filters_key      | filters                    |
| uk_councils                | idx_councils_code                                    | council_code               |
| uk_councils                | idx_councils_postcode_areas                          | postcode_areas             |
| uk_councils                | idx_councils_region                                  | region                     |
| uk_councils                | uk_councils_council_code_key                         | council_code               |
| uk_councils                | uk_councils_pkey                                     | id                         |
| users                      | confirmation_token_idx                               | confirmation_token         |
| users                      | email_change_token_current_idx                       | email_change_token_current |
| users                      | email_change_token_new_idx                           | email_change_token_new     |
| users                      | idx_users_email                                      | email                      |
| users                      | idx_users_stripe_customer                            | stripe_customer_id         |
| users                      | reauthentication_token_idx                           | reauthentication_token     |
| users                      | recovery_token_idx                                   | recovery_token             |
| users                      | users_email_key                                      | email                      |
| users                      | users_email_partial_key                              | email                      |
| users                      | users_instance_id_email_idx                          | instance_id                |
| users                      | users_instance_id_idx                                | instance_id                |
| users                      | users_is_anonymous_idx                               | is_anonymous               |
| users                      | users_phone_key                                      | phone                      |
| users                      | users_pkey                                           | id                         |
| users                      | users_pkey                                           | id                         |
| users                      | users_stripe_customer_id_key                         | stripe_customer_id         |
| vector_indexes             | vector_indexes_name_bucket_id_idx                    | bucket_id                  |
| vector_indexes             | vector_indexes_name_bucket_id_idx                    | name                       |
| vector_indexes             | vector_indexes_pkey                                  | id                         |
| webhook_logs               | idx_webhook_logs_created_at                          | created_at                 |
| webhook_logs               | idx_webhook_logs_event_type                          | event_type                 |
| webhook_logs               | idx_webhook_logs_stripe_event_id                     | stripe_event_id            |
| webhook_logs               | webhook_logs_pkey                                    | id                         |

Row-Level Security (RLS) Policies

Supabase uses RLS heavily. Claude needs these so it doesn't create migrations that break access.

SELECT
    schemaname,
    tablename,
    policyname,
    permissive,
    roles,
    cmd,
    qual,
    with_check
FROM pg_policies
ORDER BY tablename;


This is critical — many devs forget this.

| schemaname | tablename            | policyname                                       | permissive | roles           | cmd    | qual                                                                                                                                                                | with_check                                                                                                      |
| ---------- | -------------------- | ------------------------------------------------ | ---------- | --------------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| public     | ai_usage             | System can insert AI usage                       | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | true                                                                                                            |
| public     | ai_usage             | Users can view own AI usage                      | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | ai_usage_logs        | Service role can view logs                       | PERMISSIVE | {service_role}  | SELECT | true                                                                                                                                                                | null                                                                                                            |
| public     | ai_usage_logs        | Service role can insert logs                     | PERMISSIVE | {service_role}  | INSERT | null                                                                                                                                                                | true                                                                                                            |
| public     | case_facts           | Users can view own and anonymous case_facts      | PERMISSIVE | {public}        | SELECT | (case_id IN ( SELECT cases.id
   FROM cases
  WHERE ((cases.user_id = auth.uid()) OR ((cases.user_id IS NULL) AND (auth.uid() IS NULL)))))                          | null                                                                                                            |
| public     | case_facts           | Users can insert own and anonymous case_facts    | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | (case_id IN ( SELECT cases.id
   FROM cases
  WHERE ((cases.user_id = auth.uid()) OR (cases.user_id IS NULL)))) |
| public     | case_facts           | Users can update own and anonymous case_facts    | PERMISSIVE | {public}        | UPDATE | (case_id IN ( SELECT cases.id
   FROM cases
  WHERE ((cases.user_id = auth.uid()) OR (cases.user_id IS NULL))))                                                     | null                                                                                                            |
| public     | cases                | Anyone can create cases                          | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | ((user_id = auth.uid()) OR (user_id IS NULL))                                                                   |
| public     | cases                | Users can view own and anonymous cases           | PERMISSIVE | {public}        | SELECT | ((user_id = auth.uid()) OR ((user_id IS NULL) AND (auth.uid() IS NULL)))                                                                                            | null                                                                                                            |
| public     | cases                | Users can delete own cases                       | PERMISSIVE | {public}        | DELETE | (user_id = auth.uid())                                                                                                                                              | null                                                                                                            |
| public     | cases                | Users can update own and anonymous cases         | PERMISSIVE | {public}        | UPDATE | ((user_id = auth.uid()) OR (user_id IS NULL))                                                                                                                       | null                                                                                                            |
| public     | conversations        | Users can view own and anonymous conversations   | PERMISSIVE | {public}        | SELECT | (case_id IN ( SELECT cases.id
   FROM cases
  WHERE ((cases.user_id = auth.uid()) OR ((cases.user_id IS NULL) AND (auth.uid() IS NULL)))))                          | null                                                                                                            |
| public     | conversations        | Users can update own and anonymous conversations | PERMISSIVE | {public}        | UPDATE | (case_id IN ( SELECT cases.id
   FROM cases
  WHERE ((cases.user_id = auth.uid()) OR (cases.user_id IS NULL))))                                                     | null                                                                                                            |
| public     | conversations        | Users can insert own and anonymous conversations | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | (case_id IN ( SELECT cases.id
   FROM cases
  WHERE ((cases.user_id = auth.uid()) OR (cases.user_id IS NULL)))) |
| public     | councils             | Anyone can view councils                         | PERMISSIVE | {public}        | SELECT | true                                                                                                                                                                | null                                                                                                            |
| public     | councils             | Service role can manage councils                 | PERMISSIVE | {public}        | ALL    | (auth.role() = 'service_role'::text)                                                                                                                                | null                                                                                                            |
| public     | documents            | Users can update own and anonymous documents     | PERMISSIVE | {public}        | UPDATE | ((user_id = auth.uid()) OR (user_id IS NULL))                                                                                                                       | null                                                                                                            |
| public     | documents            | Users can delete own documents                   | PERMISSIVE | {public}        | DELETE | (user_id = auth.uid())                                                                                                                                              | null                                                                                                            |
| public     | documents            | Anyone can create documents                      | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | ((user_id = auth.uid()) OR (user_id IS NULL))                                                                   |
| public     | documents            | Users can view own and anonymous documents       | PERMISSIVE | {public}        | SELECT | ((user_id = auth.uid()) OR ((user_id IS NULL) AND (auth.uid() IS NULL)))                                                                                            | null                                                                                                            |
| public     | hmo_compliance_items | Users can view own compliance items              | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | hmo_compliance_items | Users can update own compliance items            | PERMISSIVE | {public}        | UPDATE | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | hmo_compliance_items | Users can delete own compliance items            | PERMISSIVE | {public}        | DELETE | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | hmo_compliance_items | Users can create own compliance items            | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | (auth.uid() = user_id)                                                                                          |
| public     | hmo_properties       | Users can create own properties                  | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | (auth.uid() = user_id)                                                                                          |
| public     | hmo_properties       | Users can update own properties                  | PERMISSIVE | {public}        | UPDATE | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | hmo_properties       | Users can delete own properties                  | PERMISSIVE | {public}        | DELETE | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | hmo_properties       | Users can view own properties                    | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | hmo_tenants          | Users can delete own tenants                     | PERMISSIVE | {public}        | DELETE | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | hmo_tenants          | Users can view own tenants                       | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | hmo_tenants          | Users can create own tenants                     | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | (auth.uid() = user_id)                                                                                          |
| public     | hmo_tenants          | Users can update own tenants                     | PERMISSIVE | {public}        | UPDATE | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| storage    | objects              | Users can delete own documents flreew_0          | PERMISSIVE | {authenticated} | DELETE | ((bucket_id = 'documents'::text) AND ((storage.foldername(name))[1] = (auth.uid())::text))                                                                          | null                                                                                                            |
| storage    | objects              | Users can upload own documents flreew_0          | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                                                | ((bucket_id = 'documents'::text) AND ((storage.foldername(name))[1] = (auth.uid())::text))                      |
| storage    | objects              | Users can view own documents flreew_0            | PERMISSIVE | {authenticated} | SELECT | ((bucket_id = 'documents'::text) AND ((storage.foldername(name))[1] = (auth.uid())::text))                                                                          | null                                                                                                            |
| public     | orders               | Users can view own orders                        | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                              | null                                                                                                            |
| public     | orders               | Users can create own orders                      | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | (auth.uid() = user_id)                                                                                          |
| public     | seo_automation_log   | seo_automation_log_admin_all                     | PERMISSIVE | {authenticated} | ALL    | (auth.uid() IN ( SELECT users.id
   FROM users
  WHERE (users.id = ANY ((string_to_array(current_setting('app.admin_user_ids'::text, true), ','::text))::uuid[])))) | null                                                                                                            |
| public     | seo_backlinks        | seo_backlinks_admin_all                          | PERMISSIVE | {authenticated} | ALL    | (auth.uid() IN ( SELECT users.id
   FROM users
  WHERE (users.id = ANY ((string_to_array(current_setting('app.admin_user_ids'::text, true), ','::text))::uuid[])))) | null                                                                                                            |
| public     | seo_content_queue    | seo_content_queue_admin_all                      | PERMISSIVE | {authenticated} | ALL    | (auth.uid() IN ( SELECT users.id
   FROM users
  WHERE (users.id = ANY ((string_to_array(current_setting('app.admin_user_ids'::text, true), ','::text))::uuid[])))) | null                                                                                                            |
| public     | seo_keywords         | seo_keywords_admin_all                           | PERMISSIVE | {authenticated} | ALL    | (auth.uid() IN ( SELECT users.id
   FROM users
  WHERE (users.id = ANY ((string_to_array(current_setting('app.admin_user_ids'::text, true), ','::text))::uuid[])))) | null                                                                                                            |
| public     | seo_pages            | seo_pages_public_read                            | PERMISSIVE | {anon}          | SELECT | (status = 'published'::text)                                                                                                                                        | null                                                                                                            |
| public     | seo_pages            | seo_admin_all                                    | PERMISSIVE | {authenticated} | ALL    | (auth.uid() IN ( SELECT users.id
   FROM users
  WHERE (users.id = ANY ((string_to_array(current_setting('app.admin_user_ids'::text, true), ','::text))::uuid[])))) | null                                                                                                            |
| public     | seo_performance      | seo_performance_admin_all                        | PERMISSIVE | {authenticated} | ALL    | (auth.uid() IN ( SELECT users.id
   FROM users
  WHERE (users.id = ANY ((string_to_array(current_setting('app.admin_user_ids'::text, true), ','::text))::uuid[])))) | null                                                                                                            |
| public     | uk_councils          | Anyone can view councils                         | PERMISSIVE | {authenticated} | SELECT | true                                                                                                                                                                | null                                                                                                            |
| public     | users                | Users can update own profile                     | PERMISSIVE | {public}        | UPDATE | (auth.uid() = id)                                                                                                                                                   | null                                                                                                            |
| public     | users                | Users can view own profile                       | PERMISSIVE | {public}        | SELECT | (auth.uid() = id)                                                                                                                                                   | null                                                                                                            |
| public     | users                | Users can insert own profile                     | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                | (auth.uid() = id)                                                                                               |
| public     | webhook_logs         | Service role can manage webhook logs             | PERMISSIVE | {service_role}  | ALL    | true                                                                                                                                                                | true                                                                                                            |

Existing Functions (e.g. edge functions, SQL functions, triggers)

If Claude is modifying workflows, it needs to know what already exists.

SELECT
    n.nspname AS schema,
    p.proname AS function_name,
    pg_catalog.pg_get_functiondef(p.oid) AS definition
FROM pg_catalog.pg_proc p
     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = p.pronamespace
WHERE n.nspname NOT IN ('pg_catalog', 'information_schema')
ORDER BY 1, 2;

| schema         | function_name                         | definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| -------------- | ------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| auth           | email                                 | CREATE OR REPLACE FUNCTION auth.email()
 RETURNS text
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.email', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'email')
  )::text
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| auth           | jwt                                   | CREATE OR REPLACE FUNCTION auth.jwt()
 RETURNS jsonb
 LANGUAGE sql
 STABLE
AS $function$
  select 
    coalesce(
        nullif(current_setting('request.jwt.claim', true), ''),
        nullif(current_setting('request.jwt.claims', true), '')
    )::jsonb
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| auth           | role                                  | CREATE OR REPLACE FUNCTION auth.role()
 RETURNS text
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.role', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'role')
  )::text
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| auth           | uid                                   | CREATE OR REPLACE FUNCTION auth.uid()
 RETURNS uuid
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.sub', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'sub')
  )::uuid
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions     | armor                                 | CREATE OR REPLACE FUNCTION extensions.armor(bytea, text[], text[])
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_armor$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| extensions     | armor                                 | CREATE OR REPLACE FUNCTION extensions.armor(bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_armor$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| extensions     | crypt                                 | CREATE OR REPLACE FUNCTION extensions.crypt(text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_crypt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions     | dearmor                               | CREATE OR REPLACE FUNCTION extensions.dearmor(text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_dearmor$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions     | decrypt                               | CREATE OR REPLACE FUNCTION extensions.decrypt(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_decrypt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions     | decrypt_iv                            | CREATE OR REPLACE FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_decrypt_iv$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions     | digest                                | CREATE OR REPLACE FUNCTION extensions.digest(text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_digest$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions     | digest                                | CREATE OR REPLACE FUNCTION extensions.digest(bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_digest$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions     | encrypt                               | CREATE OR REPLACE FUNCTION extensions.encrypt(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_encrypt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions     | encrypt_iv                            | CREATE OR REPLACE FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_encrypt_iv$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions     | gen_random_bytes                      | CREATE OR REPLACE FUNCTION extensions.gen_random_bytes(integer)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_random_bytes$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions     | gen_random_uuid                       | CREATE OR REPLACE FUNCTION extensions.gen_random_uuid()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE
AS '$libdir/pgcrypto', $function$pg_random_uuid$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions     | gen_salt                              | CREATE OR REPLACE FUNCTION extensions.gen_salt(text, integer)
 RETURNS text
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_gen_salt_rounds$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions     | gen_salt                              | CREATE OR REPLACE FUNCTION extensions.gen_salt(text)
 RETURNS text
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_gen_salt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions     | grant_pg_cron_access                  | CREATE OR REPLACE FUNCTION extensions.grant_pg_cron_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF EXISTS (
    SELECT
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_cron'
  )
  THEN
    grant usage on schema cron to postgres with grant option;

    alter default privileges in schema cron grant all on tables to postgres with grant option;
    alter default privileges in schema cron grant all on functions to postgres with grant option;
    alter default privileges in schema cron grant all on sequences to postgres with grant option;

    alter default privileges for user supabase_admin in schema cron grant all
        on sequences to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on tables to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on functions to postgres with grant option;

    grant all privileges on all tables in schema cron to postgres with grant option;
    revoke all on table cron.job from postgres;
    grant select on table cron.job to postgres with grant option;
  END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| extensions     | grant_pg_graphql_access               | CREATE OR REPLACE FUNCTION extensions.grant_pg_graphql_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    func_is_graphql_resolve bool;
BEGIN
    func_is_graphql_resolve = (
        SELECT n.proname = 'resolve'
        FROM pg_event_trigger_ddl_commands() AS ev
        LEFT JOIN pg_catalog.pg_proc AS n
        ON ev.objid = n.oid
    );

    IF func_is_graphql_resolve
    THEN
        -- Update public wrapper to pass all arguments through to the pg_graphql resolve func
        DROP FUNCTION IF EXISTS graphql_public.graphql;
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language sql
        as $$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $$;

        -- This hook executes when `graphql.resolve` is created. That is not necessarily the last
        -- function in the extension so we need to grant permissions on existing entities AND
        -- update default permissions to any others that are created after `graphql.resolve`
        grant usage on schema graphql to postgres, anon, authenticated, service_role;
        grant select on all tables in schema graphql to postgres, anon, authenticated, service_role;
        grant execute on all functions in schema graphql to postgres, anon, authenticated, service_role;
        grant all on all sequences in schema graphql to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on tables to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on functions to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on sequences to postgres, anon, authenticated, service_role;

        -- Allow postgres role to allow granting usage on graphql and graphql_public schemas to custom roles
        grant usage on schema graphql_public to postgres with grant option;
        grant usage on schema graphql to postgres with grant option;
    END IF;

END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions     | grant_pg_net_access                   | CREATE OR REPLACE FUNCTION extensions.grant_pg_net_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF EXISTS (
    SELECT 1
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_net'
  )
  THEN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_roles
      WHERE rolname = 'supabase_functions_admin'
    )
    THEN
      CREATE USER supabase_functions_admin NOINHERIT CREATEROLE LOGIN NOREPLICATION;
    END IF;

    GRANT USAGE ON SCHEMA net TO supabase_functions_admin, postgres, anon, authenticated, service_role;

    IF EXISTS (
      SELECT FROM pg_extension
      WHERE extname = 'pg_net'
      -- all versions in use on existing projects as of 2025-02-20
      -- version 0.12.0 onwards don't need these applied
      AND extversion IN ('0.2', '0.6', '0.7', '0.7.1', '0.8', '0.10.0', '0.11.0')
    ) THEN
      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;

      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;

      REVOKE ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;
      REVOKE ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;

      GRANT EXECUTE ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
      GRANT EXECUTE ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
    END IF;
  END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions     | hmac                                  | CREATE OR REPLACE FUNCTION extensions.hmac(text, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_hmac$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions     | hmac                                  | CREATE OR REPLACE FUNCTION extensions.hmac(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_hmac$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions     | pg_stat_statements                    | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone)
 RETURNS SETOF record
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_1_11$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions     | pg_stat_statements_info               | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone)
 RETURNS record
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_info$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions     | pg_stat_statements_reset              | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements_reset(userid oid DEFAULT 0, dbid oid DEFAULT 0, queryid bigint DEFAULT 0, minmax_only boolean DEFAULT false)
 RETURNS timestamp with time zone
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_reset_1_11$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions     | pgp_armor_headers                     | CREATE OR REPLACE FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text)
 RETURNS SETOF record
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_armor_headers$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions     | pgp_key_id                            | CREATE OR REPLACE FUNCTION extensions.pgp_key_id(bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_key_id_w$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions     | pgp_pub_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions     | pgp_pub_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| extensions     | pgp_pub_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions     | pgp_pub_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions     | pgp_pub_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions     | pgp_pub_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions     | pgp_pub_encrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt(text, bytea)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions     | pgp_pub_encrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt(text, bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions     | pgp_pub_encrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| extensions     | pgp_pub_encrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions     | pgp_sym_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt(bytea, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| extensions     | pgp_sym_decrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt(bytea, text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions     | pgp_sym_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions     | pgp_sym_decrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions     | pgp_sym_encrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt(text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions     | pgp_sym_encrypt                       | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt(text, text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions     | pgp_sym_encrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions     | pgp_sym_encrypt_bytea                 | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| extensions     | pgrst_ddl_watch                       | CREATE OR REPLACE FUNCTION extensions.pgrst_ddl_watch()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
  cmd record;
BEGIN
  FOR cmd IN SELECT * FROM pg_event_trigger_ddl_commands()
  LOOP
    IF cmd.command_tag IN (
      'CREATE SCHEMA', 'ALTER SCHEMA'
    , 'CREATE TABLE', 'CREATE TABLE AS', 'SELECT INTO', 'ALTER TABLE'
    , 'CREATE FOREIGN TABLE', 'ALTER FOREIGN TABLE'
    , 'CREATE VIEW', 'ALTER VIEW'
    , 'CREATE MATERIALIZED VIEW', 'ALTER MATERIALIZED VIEW'
    , 'CREATE FUNCTION', 'ALTER FUNCTION'
    , 'CREATE TRIGGER'
    , 'CREATE TYPE', 'ALTER TYPE'
    , 'CREATE RULE'
    , 'COMMENT'
    )
    -- don't notify in case of CREATE TEMP table or other objects created on pg_temp
    AND cmd.schema_name is distinct from 'pg_temp'
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions     | pgrst_drop_watch                      | CREATE OR REPLACE FUNCTION extensions.pgrst_drop_watch()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
  obj record;
BEGIN
  FOR obj IN SELECT * FROM pg_event_trigger_dropped_objects()
  LOOP
    IF obj.object_type IN (
      'schema'
    , 'table'
    , 'foreign table'
    , 'view'
    , 'materialized view'
    , 'function'
    , 'trigger'
    , 'type'
    , 'rule'
    )
    AND obj.is_temporary IS false -- no pg_temp objects
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions     | set_graphql_placeholder               | CREATE OR REPLACE FUNCTION extensions.set_graphql_placeholder()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
    DECLARE
    graphql_is_dropped bool;
    BEGIN
    graphql_is_dropped = (
        SELECT ev.schema_name = 'graphql_public'
        FROM pg_event_trigger_dropped_objects() AS ev
        WHERE ev.schema_name = 'graphql_public'
    );

    IF graphql_is_dropped
    THEN
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language plpgsql
        as $$
            DECLARE
                server_version float;
            BEGIN
                server_version = (SELECT (SPLIT_PART((select version()), ' ', 2))::float);

                IF server_version >= 14 THEN
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql extension is not enabled.'
                            )
                        )
                    );
                ELSE
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql is only available on projects running Postgres 14 onwards.'
                            )
                        )
                    );
                END IF;
            END;
        $$;
    END IF;

    END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| extensions     | uuid_generate_v1                      | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v1()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v1$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions     | uuid_generate_v1mc                    | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v1mc()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v1mc$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions     | uuid_generate_v3                      | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v3(namespace uuid, name text)
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v3$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions     | uuid_generate_v4                      | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v4()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v4$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions     | uuid_generate_v5                      | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v5(namespace uuid, name text)
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v5$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions     | uuid_nil                              | CREATE OR REPLACE FUNCTION extensions.uuid_nil()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_nil$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions     | uuid_ns_dns                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_dns()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_dns$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions     | uuid_ns_oid                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_oid()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_oid$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions     | uuid_ns_url                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_url()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_url$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions     | uuid_ns_x500                          | CREATE OR REPLACE FUNCTION extensions.uuid_ns_x500()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_x500$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| graphql        | _internal_resolve                     | CREATE OR REPLACE FUNCTION graphql._internal_resolve(query text, variables jsonb DEFAULT '{}'::jsonb, "operationName" text DEFAULT NULL::text, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE c
AS '$libdir/pg_graphql', $function$resolve_wrapper$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| graphql        | comment_directive                     | CREATE OR REPLACE FUNCTION graphql.comment_directive(comment_ text)
 RETURNS jsonb
 LANGUAGE sql
 IMMUTABLE
AS $function$
    /*
    comment on column public.account.name is '@graphql.name: myField'
    */
    select
        coalesce(
            (
                regexp_match(
                    comment_,
                    '@graphql\((.+)\)'
                )
            )[1]::jsonb,
            jsonb_build_object()
        )
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| graphql        | exception                             | CREATE OR REPLACE FUNCTION graphql.exception(message text)
 RETURNS text
 LANGUAGE plpgsql
AS $function$
begin
    raise exception using errcode='22000', message=message;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| graphql        | get_schema_version                    | CREATE OR REPLACE FUNCTION graphql.get_schema_version()
 RETURNS integer
 LANGUAGE sql
 SECURITY DEFINER
AS $function$
    select last_value from graphql.seq_schema_version;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| graphql        | increment_schema_version              | CREATE OR REPLACE FUNCTION graphql.increment_schema_version()
 RETURNS event_trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
begin
    perform pg_catalog.nextval('graphql.seq_schema_version');
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| graphql        | resolve                               | CREATE OR REPLACE FUNCTION graphql.resolve(query text, variables jsonb DEFAULT '{}'::jsonb, "operationName" text DEFAULT NULL::text, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE plpgsql
AS $function$
declare
    res jsonb;
    message_text text;
begin
  begin
    select graphql._internal_resolve("query" := "query",
                                     "variables" := "variables",
                                     "operationName" := "operationName",
                                     "extensions" := "extensions") into res;
    return res;
  exception
    when others then
    get stacked diagnostics message_text = message_text;
    return
    jsonb_build_object('data', null,
                       'errors', jsonb_build_array(jsonb_build_object('message', message_text)));
  end;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| graphql_public | graphql                               | CREATE OR REPLACE FUNCTION graphql_public.graphql("operationName" text DEFAULT NULL::text, query text DEFAULT NULL::text, variables jsonb DEFAULT NULL::jsonb, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE sql
AS $function$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| pgbouncer      | get_auth                              | CREATE OR REPLACE FUNCTION pgbouncer.get_auth(p_usename text)
 RETURNS TABLE(username text, password text)
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
begin
    raise debug 'PgBouncer auth request: %', p_usename;

    return query
    select 
        rolname::text, 
        case when rolvaliduntil < now() 
            then null 
            else rolpassword::text 
        end 
    from pg_authid 
    where rolname=$1 and rolcanlogin;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public         | update_councils_updated_at            | CREATE OR REPLACE FUNCTION public.update_councils_updated_at()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| public         | update_seo_updated_at                 | CREATE OR REPLACE FUNCTION public.update_seo_updated_at()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public         | update_updated_at_column              | CREATE OR REPLACE FUNCTION public.update_updated_at_column()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| realtime       | apply_rls                             | CREATE OR REPLACE FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer DEFAULT (1024 * 1024))
 RETURNS SETOF realtime.wal_rls
 LANGUAGE plpgsql
AS $function$
declare
-- Regclass of the table e.g. public.notes
entity_ regclass = (quote_ident(wal ->> 'schema') || '.' || quote_ident(wal ->> 'table'))::regclass;

-- I, U, D, T: insert, update ...
action realtime.action = (
    case wal ->> 'action'
        when 'I' then 'INSERT'
        when 'U' then 'UPDATE'
        when 'D' then 'DELETE'
        else 'ERROR'
    end
);

-- Is row level security enabled for the table
is_rls_enabled bool = relrowsecurity from pg_class where oid = entity_;

subscriptions realtime.subscription[] = array_agg(subs)
    from
        realtime.subscription subs
    where
        subs.entity = entity_;

-- Subscription vars
roles regrole[] = array_agg(distinct us.claims_role::text)
    from
        unnest(subscriptions) us;

working_role regrole;
claimed_role regrole;
claims jsonb;

subscription_id uuid;
subscription_has_access bool;
visible_to_subscription_ids uuid[] = '{}';

-- structured info for wal's columns
columns realtime.wal_column[];
-- previous identity values for update/delete
old_columns realtime.wal_column[];

error_record_exceeds_max_size boolean = octet_length(wal::text) > max_record_bytes;

-- Primary jsonb output for record
output jsonb;

begin
perform set_config('role', null, true);

columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}'